TakeOrderedAndProject [channel,id,sales,returns,profit]
  WholeStageCodegen (76)
    HashAggregate [channel,id,sales,returns,profit]
      InputAdapter
        Exchange [channel,id,sales,returns,profit] #1
          WholeStageCodegen (75)
            HashAggregate [channel,id,sales,returns,profit]
              InputAdapter
                Union
                  WholeStageCodegen (24)
                    HashAggregate [channel,id,sum,isEmpty,sum,isEmpty,sum,isEmpty] [sum(sales),sum(returns),sum(profit),sales,returns,profit,sum,isEmpty,sum,isEmpty,sum,isEmpty]
                      InputAdapter
                        Exchange [channel,id] #2
                          WholeStageCodegen (23)
                            HashAggregate [channel,id,sales,returns,profit] [sum,isEmpty,sum,isEmpty,sum,isEmpty,sum,isEmpty,sum,isEmpty,sum,isEmpty]
                              InputAdapter
                                Union
                                  WholeStageCodegen (8)
                                    Project [s_store_sk,sales,returns,profit,profit_loss]
                                      BroadcastHashJoin [s_store_sk,s_store_sk]
                                        HashAggregate [s_store_sk,sum,isEmpty,sum,isEmpty] [sum(_pushedexpression),sum(_pushedexpression),sales,profit,sum,isEmpty,sum,isEmpty]
                                          InputAdapter
                                            Exchange [s_store_sk] #3
                                              WholeStageCodegen (3)
                                                HashAggregate [s_store_sk,_pushedexpression,_pushedexpression] [sum,isEmpty,sum,isEmpty,sum,isEmpty,sum,isEmpty]
                                                  Project [_pushedexpression,_pushedexpression,s_store_sk]
                                                    BroadcastHashJoin [ss_store_sk,s_store_sk]
                                                      Project [ss_store_sk,sum,sum]
                                                        HashAggregate [ss_store_sk,ss_ext_sales_price,ss_net_profit] [sum,sum,sum,sum]
                                                          BroadcastHashJoin [ss_sold_date_sk,d_date_sk]
                                                            Filter [ss_store_sk]
                                                              ColumnarToRow
                                                                InputAdapter
                                                                  Scan parquet default.store_sales [ss_sold_time_sk,ss_item_sk,ss_customer_sk,ss_cdemo_sk,ss_hdemo_sk,ss_addr_sk,ss_store_sk,ss_promo_sk,ss_ticket_number,ss_quantity,ss_wholesale_cost,ss_list_price,ss_sales_price,ss_ext_discount_amt,ss_ext_sales_price,ss_ext_wholesale_cost,ss_ext_list_price,ss_ext_tax,ss_coupon_amt,ss_net_paid,ss_net_paid_inc_tax,ss_net_profit,ss_sold_date_sk]
                                                                    SubqueryBroadcast [d_date_sk] #1
                                                                      BroadcastExchange #4
                                                                        WholeStageCodegen (1)
                                                                          Filter [d_date,d_date_sk]
                                                                            ColumnarToRow
                                                                              InputAdapter
                                                                                Scan parquet default.date_dim [d_date_sk,d_date_id,d_date,d_month_seq,d_week_seq,d_quarter_seq,d_year,d_dow,d_moy,d_dom,d_qoy,d_fy_year,d_fy_quarter_seq,d_fy_week_seq,d_day_name,d_quarter_name,d_holiday,d_weekend,d_following_holiday,d_first_dom,d_last_dom,d_same_day_ly,d_same_day_lq,d_current_day,d_current_week,d_current_month,d_current_quarter,d_current_year]
                                                            InputAdapter
                                                              ReusedExchange [d_date_sk,d_date_id,d_date,d_month_seq,d_week_seq,d_quarter_seq,d_year,d_dow,d_moy,d_dom,d_qoy,d_fy_year,d_fy_quarter_seq,d_fy_week_seq,d_day_name,d_quarter_name,d_holiday,d_weekend,d_following_holiday,d_first_dom,d_last_dom,d_same_day_ly,d_same_day_lq,d_current_day,d_current_week,d_current_month,d_current_quarter,d_current_year] #4
                                                      InputAdapter
                                                        BroadcastExchange #5
                                                          WholeStageCodegen (2)
                                                            HashAggregate [s_store_sk]
                                                              Filter [s_store_sk]
                                                                ColumnarToRow
                                                                  InputAdapter
                                                                    Scan parquet default.store [s_store_sk,s_store_id,s_rec_start_date,s_rec_end_date,s_closed_date_sk,s_store_name,s_number_employees,s_floor_space,s_hours,s_manager,s_market_id,s_geography_class,s_market_desc,s_market_manager,s_division_id,s_division_name,s_company_id,s_company_name,s_street_number,s_street_name,s_street_type,s_suite_number,s_city,s_county,s_state,s_zip,s_country,s_gmt_offset,s_tax_percentage]
                                        InputAdapter
                                          BroadcastExchange #6
                                            WholeStageCodegen (7)
                                              HashAggregate [s_store_sk,sum,isEmpty,sum,isEmpty] [sum(_pushedexpression),sum(_pushedexpression),returns,profit_loss,sum,isEmpty,sum,isEmpty]
                                                InputAdapter
                                                  Exchange [s_store_sk] #7
                                                    WholeStageCodegen (6)
                                                      HashAggregate [s_store_sk,_pushedexpression,_pushedexpression] [sum,isEmpty,sum,isEmpty,sum,isEmpty,sum,isEmpty]
                                                        Project [_pushedexpression,_pushedexpression,s_store_sk]
                                                          BroadcastHashJoin [sr_store_sk,s_store_sk]
                                                            Project [sr_store_sk,sum,sum]
                                                              HashAggregate [sr_store_sk,sr_return_amt,sr_net_loss] [sum,sum,sum,sum]
                                                                BroadcastHashJoin [sr_returned_date_sk,d_date_sk]
                                                                  Filter [sr_store_sk]
                                                                    ColumnarToRow
                                                                      InputAdapter
                                                                        Scan parquet default.store_returns [sr_return_time_sk,sr_item_sk,sr_customer_sk,sr_cdemo_sk,sr_hdemo_sk,sr_addr_sk,sr_store_sk,sr_reason_sk,sr_ticket_number,sr_return_quantity,sr_return_amt,sr_return_tax,sr_return_amt_inc_tax,sr_fee,sr_return_ship_cost,sr_refunded_cash,sr_reversed_charge,sr_store_credit,sr_net_loss,sr_returned_date_sk]
                                                                          ReusedSubquery [d_date_sk] #1
                                                                  InputAdapter
                                                                    ReusedExchange [d_date_sk,d_date_id,d_date,d_month_seq,d_week_seq,d_quarter_seq,d_year,d_dow,d_moy,d_dom,d_qoy,d_fy_year,d_fy_quarter_seq,d_fy_week_seq,d_day_name,d_quarter_name,d_holiday,d_weekend,d_following_holiday,d_first_dom,d_last_dom,d_same_day_ly,d_same_day_lq,d_current_day,d_current_week,d_current_month,d_current_quarter,d_current_year] #4
                                                            InputAdapter
                                                              ReusedExchange [s_store_sk] #5
                                  WholeStageCodegen (14)
                                    Project [cs_call_center_sk,sales,returns,profit,profit_loss]
                                      BroadcastNestedLoopJoin
                                        InputAdapter
                                          BroadcastExchange #8
                                            WholeStageCodegen (11)
                                              HashAggregate [cs_call_center_sk,sum,isEmpty,sum,isEmpty] [sum(_pushedexpression),sum(_pushedexpression),sales,profit,sum,isEmpty,sum,isEmpty]
                                                InputAdapter
                                                  Exchange [cs_call_center_sk] #9
                                                    WholeStageCodegen (10)
                                                      HashAggregate [cs_call_center_sk,_pushedexpression,_pushedexpression] [sum,isEmpty,sum,isEmpty,sum,isEmpty,sum,isEmpty]
                                                        Project [cs_call_center_sk,_pushedexpression,_pushedexpression]
                                                          BroadcastHashJoin [cs_sold_date_sk,d_date_sk]
                                                            Project [cs_sold_date_sk,cs_call_center_sk,sum,sum]
                                                              HashAggregate [cs_sold_date_sk,cs_call_center_sk,cs_ext_sales_price,cs_net_profit] [sum,sum,sum,sum]
                                                                ColumnarToRow
                                                                  InputAdapter
                                                                    Scan parquet default.catalog_sales [cs_sold_time_sk,cs_ship_date_sk,cs_bill_customer_sk,cs_bill_cdemo_sk,cs_bill_hdemo_sk,cs_bill_addr_sk,cs_ship_customer_sk,cs_ship_cdemo_sk,cs_ship_hdemo_sk,cs_ship_addr_sk,cs_call_center_sk,cs_catalog_page_sk,cs_ship_mode_sk,cs_warehouse_sk,cs_item_sk,cs_promo_sk,cs_order_number,cs_quantity,cs_wholesale_cost,cs_list_price,cs_sales_price,cs_ext_discount_amt,cs_ext_sales_price,cs_ext_wholesale_cost,cs_ext_list_price,cs_ext_tax,cs_coupon_amt,cs_ext_ship_cost,cs_net_paid,cs_net_paid_inc_tax,cs_net_paid_inc_ship,cs_net_paid_inc_ship_tax,cs_net_profit,cs_sold_date_sk]
                                                                      SubqueryBroadcast [d_date_sk] #2
                                                                        BroadcastExchange #10
                                                                          WholeStageCodegen (1)
                                                                            HashAggregate [d_date_sk]
                                                                              Filter [d_date,d_date_sk]
                                                                                ColumnarToRow
                                                                                  InputAdapter
                                                                                    Scan parquet default.date_dim [d_date_sk,d_date_id,d_date,d_month_seq,d_week_seq,d_quarter_seq,d_year,d_dow,d_moy,d_dom,d_qoy,d_fy_year,d_fy_quarter_seq,d_fy_week_seq,d_day_name,d_quarter_name,d_holiday,d_weekend,d_following_holiday,d_first_dom,d_last_dom,d_same_day_ly,d_same_day_lq,d_current_day,d_current_week,d_current_month,d_current_quarter,d_current_year]
                                                            InputAdapter
                                                              ReusedExchange [d_date_sk] #10
                                        HashAggregate [sum,isEmpty,sum,isEmpty] [sum(_pushedexpression),sum(_pushedexpression),returns,profit_loss,sum,isEmpty,sum,isEmpty]
                                          InputAdapter
                                            Exchange #11
                                              WholeStageCodegen (13)
                                                HashAggregate [_pushedexpression,_pushedexpression] [sum,isEmpty,sum,isEmpty,sum,isEmpty,sum,isEmpty]
                                                  Project [_pushedexpression,_pushedexpression]
                                                    BroadcastHashJoin [cr_returned_date_sk,d_date_sk]
                                                      Project [cr_returned_date_sk,sum,sum]
                                                        HashAggregate [cr_returned_date_sk,cr_return_amount,cr_net_loss] [sum,sum,sum,sum]
                                                          ColumnarToRow
                                                            InputAdapter
                                                              Scan parquet default.catalog_returns [cr_returned_time_sk,cr_item_sk,cr_refunded_customer_sk,cr_refunded_cdemo_sk,cr_refunded_hdemo_sk,cr_refunded_addr_sk,cr_returning_customer_sk,cr_returning_cdemo_sk,cr_returning_hdemo_sk,cr_returning_addr_sk,cr_call_center_sk,cr_catalog_page_sk,cr_ship_mode_sk,cr_warehouse_sk,cr_reason_sk,cr_order_number,cr_return_quantity,cr_return_amount,cr_return_tax,cr_return_amt_inc_tax,cr_fee,cr_return_ship_cost,cr_refunded_cash,cr_reversed_charge,cr_store_credit,cr_net_loss,cr_returned_date_sk]
                                                                ReusedSubquery [d_date_sk] #2
                                                      InputAdapter
                                                        ReusedExchange [d_date_sk] #10
                                  WholeStageCodegen (22)
                                    Project [wp_web_page_sk,sales,returns,profit,profit_loss]
                                      BroadcastHashJoin [wp_web_page_sk,wp_web_page_sk]
                                        HashAggregate [wp_web_page_sk,sum,isEmpty,sum,isEmpty] [sum(_pushedexpression),sum(_pushedexpression),sales,profit,sum,isEmpty,sum,isEmpty]
                                          InputAdapter
                                            Exchange [wp_web_page_sk] #12
                                              WholeStageCodegen (17)
                                                HashAggregate [wp_web_page_sk,_pushedexpression,_pushedexpression] [sum,isEmpty,sum,isEmpty,sum,isEmpty,sum,isEmpty]
                                                  Project [_pushedexpression,_pushedexpression,wp_web_page_sk]
                                                    BroadcastHashJoin [ws_web_page_sk,wp_web_page_sk]
                                                      Project [ws_web_page_sk,sum,sum]
                                                        HashAggregate [ws_web_page_sk,ws_ext_sales_price,ws_net_profit] [sum,sum,sum,sum]
                                                          BroadcastHashJoin [ws_sold_date_sk,d_date_sk]
                                                            Filter [ws_web_page_sk]
                                                              ColumnarToRow
                                                                InputAdapter
                                                                  Scan parquet default.web_sales [ws_sold_time_sk,ws_ship_date_sk,ws_item_sk,ws_bill_customer_sk,ws_bill_cdemo_sk,ws_bill_hdemo_sk,ws_bill_addr_sk,ws_ship_customer_sk,ws_ship_cdemo_sk,ws_ship_hdemo_sk,ws_ship_addr_sk,ws_web_page_sk,ws_web_site_sk,ws_ship_mode_sk,ws_warehouse_sk,ws_promo_sk,ws_order_number,ws_quantity,ws_wholesale_cost,ws_list_price,ws_sales_price,ws_ext_discount_amt,ws_ext_sales_price,ws_ext_wholesale_cost,ws_ext_list_price,ws_ext_tax,ws_coupon_amt,ws_ext_ship_cost,ws_net_paid,ws_net_paid_inc_tax,ws_net_paid_inc_ship,ws_net_paid_inc_ship_tax,ws_net_profit,ws_sold_date_sk]
                                                                    ReusedSubquery [d_date_sk] #1
                                                            InputAdapter
                                                              ReusedExchange [d_date_sk,d_date_id,d_date,d_month_seq,d_week_seq,d_quarter_seq,d_year,d_dow,d_moy,d_dom,d_qoy,d_fy_year,d_fy_quarter_seq,d_fy_week_seq,d_day_name,d_quarter_name,d_holiday,d_weekend,d_following_holiday,d_first_dom,d_last_dom,d_same_day_ly,d_same_day_lq,d_current_day,d_current_week,d_current_month,d_current_quarter,d_current_year] #4
                                                      InputAdapter
                                                        BroadcastExchange #13
                                                          WholeStageCodegen (16)
                                                            HashAggregate [wp_web_page_sk]
                                                              Filter [wp_web_page_sk]
                                                                ColumnarToRow
                                                                  InputAdapter
                                                                    Scan parquet default.web_page [wp_web_page_sk,wp_web_page_id,wp_rec_start_date,wp_rec_end_date,wp_creation_date_sk,wp_access_date_sk,wp_autogen_flag,wp_customer_sk,wp_url,wp_type,wp_char_count,wp_link_count,wp_image_count,wp_max_ad_count]
                                        InputAdapter
                                          BroadcastExchange #14
                                            WholeStageCodegen (21)
                                              HashAggregate [wp_web_page_sk,sum,isEmpty,sum,isEmpty] [sum(_pushedexpression),sum(_pushedexpression),returns,profit_loss,sum,isEmpty,sum,isEmpty]
                                                InputAdapter
                                                  Exchange [wp_web_page_sk] #15
                                                    WholeStageCodegen (20)
                                                      HashAggregate [wp_web_page_sk,_pushedexpression,_pushedexpression] [sum,isEmpty,sum,isEmpty,sum,isEmpty,sum,isEmpty]
                                                        Project [_pushedexpression,_pushedexpression,wp_web_page_sk]
                                                          BroadcastHashJoin [wr_web_page_sk,wp_web_page_sk]
                                                            Project [wr_web_page_sk,sum,sum]
                                                              HashAggregate [wr_web_page_sk,wr_return_amt,wr_net_loss] [sum,sum,sum,sum]
                                                                BroadcastHashJoin [wr_returned_date_sk,d_date_sk]
                                                                  Filter [wr_web_page_sk]
                                                                    ColumnarToRow
                                                                      InputAdapter
                                                                        Scan parquet default.web_returns [wr_returned_time_sk,wr_item_sk,wr_refunded_customer_sk,wr_refunded_cdemo_sk,wr_refunded_hdemo_sk,wr_refunded_addr_sk,wr_returning_customer_sk,wr_returning_cdemo_sk,wr_returning_hdemo_sk,wr_returning_addr_sk,wr_web_page_sk,wr_reason_sk,wr_order_number,wr_return_quantity,wr_return_amt,wr_return_tax,wr_return_amt_inc_tax,wr_fee,wr_return_ship_cost,wr_refunded_cash,wr_reversed_charge,wr_account_credit,wr_net_loss,wr_returned_date_sk]
                                                                          ReusedSubquery [d_date_sk] #1
                                                                  InputAdapter
                                                                    ReusedExchange [d_date_sk,d_date_id,d_date,d_month_seq,d_week_seq,d_quarter_seq,d_year,d_dow,d_moy,d_dom,d_qoy,d_fy_year,d_fy_quarter_seq,d_fy_week_seq,d_day_name,d_quarter_name,d_holiday,d_weekend,d_following_holiday,d_first_dom,d_last_dom,d_same_day_ly,d_same_day_lq,d_current_day,d_current_week,d_current_month,d_current_quarter,d_current_year] #4
                                                            InputAdapter
                                                              ReusedExchange [wp_web_page_sk] #13
                  WholeStageCodegen (49)
                    HashAggregate [channel,sum,isEmpty,sum,isEmpty,sum,isEmpty] [sum(sales),sum(returns),sum(profit),id,sales,returns,profit,sum,isEmpty,sum,isEmpty,sum,isEmpty]
                      InputAdapter
                        Exchange [channel] #16
                          WholeStageCodegen (48)
                            HashAggregate [channel,sales,returns,profit] [sum,isEmpty,sum,isEmpty,sum,isEmpty,sum,isEmpty,sum,isEmpty,sum,isEmpty]
                              HashAggregate [channel,id,sum,isEmpty,sum,isEmpty,sum,isEmpty] [sum(sales),sum(returns),sum(profit),sales,returns,profit,sum,isEmpty,sum,isEmpty,sum,isEmpty]
                                InputAdapter
                                  ReusedExchange [channel,id,sum,isEmpty,sum,isEmpty,sum,isEmpty] #2
                  WholeStageCodegen (74)
                    HashAggregate [sum,isEmpty,sum,isEmpty,sum,isEmpty] [sum(sales),sum(returns),sum(profit),channel,id,sales,returns,profit,sum,isEmpty,sum,isEmpty,sum,isEmpty]
                      InputAdapter
                        Exchange #17
                          WholeStageCodegen (73)
                            HashAggregate [sales,returns,profit] [sum,isEmpty,sum,isEmpty,sum,isEmpty,sum,isEmpty,sum,isEmpty,sum,isEmpty]
                              HashAggregate [channel,id,sum,isEmpty,sum,isEmpty,sum,isEmpty] [sum(sales),sum(returns),sum(profit),sales,returns,profit,sum,isEmpty,sum,isEmpty,sum,isEmpty]
                                InputAdapter
                                  ReusedExchange [channel,id,sum,isEmpty,sum,isEmpty,sum,isEmpty] #2
