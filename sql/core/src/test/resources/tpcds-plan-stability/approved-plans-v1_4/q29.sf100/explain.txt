== Physical Plan ==
TakeOrderedAndProject (47)
+- * HashAggregate (46)
   +- Exchange (45)
      +- * HashAggregate (44)
         +- * Project (43)
            +- * SortMergeJoin Inner (42)
               :- * Sort (35)
               :  +- Exchange (34)
               :     +- * Project (33)
               :        +- HashAggregate (32)
               :           +- Project (31)
               :              +- SortMergeJoin Inner (30)
               :                 :- Sort (22)
               :                 :  +- Exchange (21)
               :                 :     +- SortMergeJoin Inner (20)
               :                 :        :- * Sort (12)
               :                 :        :  +- Exchange (11)
               :                 :        :     +- * BroadcastHashJoin Inner BuildRight (10)
               :                 :        :        :- * BroadcastHashJoin Inner BuildRight (5)
               :                 :        :        :  :- * Filter (3)
               :                 :        :        :  :  +- * ColumnarToRow (2)
               :                 :        :        :  :     +- Scan parquet default.store_sales (1)
               :                 :        :        :  +- ReusedExchange (4)
               :                 :        :        +- BroadcastExchange (9)
               :                 :        :           +- * Filter (8)
               :                 :        :              +- * ColumnarToRow (7)
               :                 :        :                 +- Scan parquet default.store (6)
               :                 :        +- * Sort (19)
               :                 :           +- Exchange (18)
               :                 :              +- * BroadcastHashJoin Inner BuildRight (17)
               :                 :                 :- * Filter (15)
               :                 :                 :  +- * ColumnarToRow (14)
               :                 :                 :     +- Scan parquet default.store_returns (13)
               :                 :                 +- ReusedExchange (16)
               :                 +- * Sort (29)
               :                    +- Exchange (28)
               :                       +- * BroadcastHashJoin Inner BuildRight (27)
               :                          :- * Filter (25)
               :                          :  +- * ColumnarToRow (24)
               :                          :     +- Scan parquet default.catalog_sales (23)
               :                          +- ReusedExchange (26)
               +- * Sort (41)
                  +- Exchange (40)
                     +- * HashAggregate (39)
                        +- * Filter (38)
                           +- * ColumnarToRow (37)
                              +- Scan parquet default.item (36)


(1) Scan parquet default.store_sales
Output [23]: [ss_sold_time_sk#1, ss_item_sk#2, ss_customer_sk#3, ss_cdemo_sk#4, ss_hdemo_sk#5, ss_addr_sk#6, ss_store_sk#7, ss_promo_sk#8, ss_ticket_number#9, ss_quantity#10, ss_wholesale_cost#11, ss_list_price#12, ss_sales_price#13, ss_ext_discount_amt#14, ss_ext_sales_price#15, ss_ext_wholesale_cost#16, ss_ext_list_price#17, ss_ext_tax#18, ss_coupon_amt#19, ss_net_paid#20, ss_net_paid_inc_tax#21, ss_net_profit#22, ss_sold_date_sk#23]
Batched: true
Location: InMemoryFileIndex []
PartitionFilters: [isnotnull(ss_sold_date_sk#23), dynamicpruningexpression(ss_sold_date_sk#23 IN dynamicpruning#24)]
PushedFilters: [IsNotNull(ss_customer_sk), IsNotNull(ss_item_sk), IsNotNull(ss_ticket_number), IsNotNull(ss_store_sk)]
ReadSchema: struct<ss_sold_time_sk:int,ss_item_sk:int,ss_customer_sk:int,ss_cdemo_sk:int,ss_hdemo_sk:int,ss_addr_sk:int,ss_store_sk:int,ss_promo_sk:int,ss_ticket_number:int,ss_quantity:int,ss_wholesale_cost:decimal(7,2),ss_list_price:decimal(7,2),ss_sales_price:decimal(7,2),ss_ext_discount_amt:decimal(7,2),ss_ext_sales_price:decimal(7,2),ss_ext_wholesale_cost:decimal(7,2),ss_ext_list_price:decimal(7,2),ss_ext_tax:decimal(7,2),ss_coupon_amt:decimal(7,2),ss_net_paid:decimal(7,2),ss_net_paid_inc_tax:decimal(7,2),ss_net_profit:decimal(7,2)>

(2) ColumnarToRow [codegen id : 3]
Input [23]: [ss_sold_time_sk#1, ss_item_sk#2, ss_customer_sk#3, ss_cdemo_sk#4, ss_hdemo_sk#5, ss_addr_sk#6, ss_store_sk#7, ss_promo_sk#8, ss_ticket_number#9, ss_quantity#10, ss_wholesale_cost#11, ss_list_price#12, ss_sales_price#13, ss_ext_discount_amt#14, ss_ext_sales_price#15, ss_ext_wholesale_cost#16, ss_ext_list_price#17, ss_ext_tax#18, ss_coupon_amt#19, ss_net_paid#20, ss_net_paid_inc_tax#21, ss_net_profit#22, ss_sold_date_sk#23]

(3) Filter [codegen id : 3]
Input [23]: [ss_sold_time_sk#1, ss_item_sk#2, ss_customer_sk#3, ss_cdemo_sk#4, ss_hdemo_sk#5, ss_addr_sk#6, ss_store_sk#7, ss_promo_sk#8, ss_ticket_number#9, ss_quantity#10, ss_wholesale_cost#11, ss_list_price#12, ss_sales_price#13, ss_ext_discount_amt#14, ss_ext_sales_price#15, ss_ext_wholesale_cost#16, ss_ext_list_price#17, ss_ext_tax#18, ss_coupon_amt#19, ss_net_paid#20, ss_net_paid_inc_tax#21, ss_net_profit#22, ss_sold_date_sk#23]
Condition : (((isnotnull(ss_customer_sk#3) AND isnotnull(ss_item_sk#2)) AND isnotnull(ss_ticket_number#9)) AND isnotnull(ss_store_sk#7))

(4) ReusedExchange [Reuses operator id: 51]
Output [28]: [d_date_sk#25, d_date_id#26, d_date#27, d_month_seq#28, d_week_seq#29, d_quarter_seq#30, d_year#31, d_dow#32, d_moy#33, d_dom#34, d_qoy#35, d_fy_year#36, d_fy_quarter_seq#37, d_fy_week_seq#38, d_day_name#39, d_quarter_name#40, d_holiday#41, d_weekend#42, d_following_holiday#43, d_first_dom#44, d_last_dom#45, d_same_day_ly#46, d_same_day_lq#47, d_current_day#48, d_current_week#49, d_current_month#50, d_current_quarter#51, d_current_year#52]

(5) BroadcastHashJoin [codegen id : 3]
Left keys [1]: [ss_sold_date_sk#23]
Right keys [1]: [d_date_sk#25]
Join condition: None

(6) Scan parquet default.store
Output [29]: [s_store_sk#53, s_store_id#54, s_rec_start_date#55, s_rec_end_date#56, s_closed_date_sk#57, s_store_name#58, s_number_employees#59, s_floor_space#60, s_hours#61, s_manager#62, s_market_id#63, s_geography_class#64, s_market_desc#65, s_market_manager#66, s_division_id#67, s_division_name#68, s_company_id#69, s_company_name#70, s_street_number#71, s_street_name#72, s_street_type#73, s_suite_number#74, s_city#75, s_county#76, s_state#77, s_zip#78, s_country#79, s_gmt_offset#80, s_tax_percentage#81]
Batched: true
Location [not included in comparison]/{warehouse_dir}/store]
PushedFilters: [IsNotNull(s_store_sk)]
ReadSchema: struct<s_store_sk:int,s_store_id:string,s_rec_start_date:date,s_rec_end_date:date,s_closed_date_sk:int,s_store_name:string,s_number_employees:int,s_floor_space:int,s_hours:string,s_manager:string,s_market_id:int,s_geography_class:string,s_market_desc:string,s_market_manager:string,s_division_id:int,s_division_name:string,s_company_id:int,s_company_name:string,s_street_number:string,s_street_name:string,s_street_type:string,s_suite_number:string,s_city:string,s_county:string,s_state:string,s_zip:string,s_country:string,s_gmt_offset:decimal(5,2),s_tax_percentage:decimal(5,2)>

(7) ColumnarToRow [codegen id : 2]
Input [29]: [s_store_sk#53, s_store_id#54, s_rec_start_date#55, s_rec_end_date#56, s_closed_date_sk#57, s_store_name#58, s_number_employees#59, s_floor_space#60, s_hours#61, s_manager#62, s_market_id#63, s_geography_class#64, s_market_desc#65, s_market_manager#66, s_division_id#67, s_division_name#68, s_company_id#69, s_company_name#70, s_street_number#71, s_street_name#72, s_street_type#73, s_suite_number#74, s_city#75, s_county#76, s_state#77, s_zip#78, s_country#79, s_gmt_offset#80, s_tax_percentage#81]

(8) Filter [codegen id : 2]
Input [29]: [s_store_sk#53, s_store_id#54, s_rec_start_date#55, s_rec_end_date#56, s_closed_date_sk#57, s_store_name#58, s_number_employees#59, s_floor_space#60, s_hours#61, s_manager#62, s_market_id#63, s_geography_class#64, s_market_desc#65, s_market_manager#66, s_division_id#67, s_division_name#68, s_company_id#69, s_company_name#70, s_street_number#71, s_street_name#72, s_street_type#73, s_suite_number#74, s_city#75, s_county#76, s_state#77, s_zip#78, s_country#79, s_gmt_offset#80, s_tax_percentage#81]
Condition : isnotnull(s_store_sk#53)

(9) BroadcastExchange
Input [29]: [s_store_sk#53, s_store_id#54, s_rec_start_date#55, s_rec_end_date#56, s_closed_date_sk#57, s_store_name#58, s_number_employees#59, s_floor_space#60, s_hours#61, s_manager#62, s_market_id#63, s_geography_class#64, s_market_desc#65, s_market_manager#66, s_division_id#67, s_division_name#68, s_company_id#69, s_company_name#70, s_street_number#71, s_street_name#72, s_street_type#73, s_suite_number#74, s_city#75, s_county#76, s_state#77, s_zip#78, s_country#79, s_gmt_offset#80, s_tax_percentage#81]
Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#82]

(10) BroadcastHashJoin [codegen id : 3]
Left keys [1]: [ss_store_sk#7]
Right keys [1]: [s_store_sk#53]
Join condition: None

(11) Exchange
Input [80]: [ss_sold_time_sk#1, ss_item_sk#2, ss_customer_sk#3, ss_cdemo_sk#4, ss_hdemo_sk#5, ss_addr_sk#6, ss_store_sk#7, ss_promo_sk#8, ss_ticket_number#9, ss_quantity#10, ss_wholesale_cost#11, ss_list_price#12, ss_sales_price#13, ss_ext_discount_amt#14, ss_ext_sales_price#15, ss_ext_wholesale_cost#16, ss_ext_list_price#17, ss_ext_tax#18, ss_coupon_amt#19, ss_net_paid#20, ss_net_paid_inc_tax#21, ss_net_profit#22, ss_sold_date_sk#23, d_date_sk#25, d_date_id#26, d_date#27, d_month_seq#28, d_week_seq#29, d_quarter_seq#30, d_year#31, d_dow#32, d_moy#33, d_dom#34, d_qoy#35, d_fy_year#36, d_fy_quarter_seq#37, d_fy_week_seq#38, d_day_name#39, d_quarter_name#40, d_holiday#41, d_weekend#42, d_following_holiday#43, d_first_dom#44, d_last_dom#45, d_same_day_ly#46, d_same_day_lq#47, d_current_day#48, d_current_week#49, d_current_month#50, d_current_quarter#51, d_current_year#52, s_store_sk#53, s_store_id#54, s_rec_start_date#55, s_rec_end_date#56, s_closed_date_sk#57, s_store_name#58, s_number_employees#59, s_floor_space#60, s_hours#61, s_manager#62, s_market_id#63, s_geography_class#64, s_market_desc#65, s_market_manager#66, s_division_id#67, s_division_name#68, s_company_id#69, s_company_name#70, s_street_number#71, s_street_name#72, s_street_type#73, s_suite_number#74, s_city#75, s_county#76, s_state#77, s_zip#78, s_country#79, s_gmt_offset#80, s_tax_percentage#81]
Arguments: hashpartitioning(ss_customer_sk#3, ss_item_sk#2, ss_ticket_number#9, 5), ENSURE_REQUIREMENTS, [id=#83]

(12) Sort [codegen id : 4]
Input [80]: [ss_sold_time_sk#1, ss_item_sk#2, ss_customer_sk#3, ss_cdemo_sk#4, ss_hdemo_sk#5, ss_addr_sk#6, ss_store_sk#7, ss_promo_sk#8, ss_ticket_number#9, ss_quantity#10, ss_wholesale_cost#11, ss_list_price#12, ss_sales_price#13, ss_ext_discount_amt#14, ss_ext_sales_price#15, ss_ext_wholesale_cost#16, ss_ext_list_price#17, ss_ext_tax#18, ss_coupon_amt#19, ss_net_paid#20, ss_net_paid_inc_tax#21, ss_net_profit#22, ss_sold_date_sk#23, d_date_sk#25, d_date_id#26, d_date#27, d_month_seq#28, d_week_seq#29, d_quarter_seq#30, d_year#31, d_dow#32, d_moy#33, d_dom#34, d_qoy#35, d_fy_year#36, d_fy_quarter_seq#37, d_fy_week_seq#38, d_day_name#39, d_quarter_name#40, d_holiday#41, d_weekend#42, d_following_holiday#43, d_first_dom#44, d_last_dom#45, d_same_day_ly#46, d_same_day_lq#47, d_current_day#48, d_current_week#49, d_current_month#50, d_current_quarter#51, d_current_year#52, s_store_sk#53, s_store_id#54, s_rec_start_date#55, s_rec_end_date#56, s_closed_date_sk#57, s_store_name#58, s_number_employees#59, s_floor_space#60, s_hours#61, s_manager#62, s_market_id#63, s_geography_class#64, s_market_desc#65, s_market_manager#66, s_division_id#67, s_division_name#68, s_company_id#69, s_company_name#70, s_street_number#71, s_street_name#72, s_street_type#73, s_suite_number#74, s_city#75, s_county#76, s_state#77, s_zip#78, s_country#79, s_gmt_offset#80, s_tax_percentage#81]
Arguments: [ss_customer_sk#3 ASC NULLS FIRST, ss_item_sk#2 ASC NULLS FIRST, ss_ticket_number#9 ASC NULLS FIRST], false, 0

(13) Scan parquet default.store_returns
Output [20]: [sr_return_time_sk#84, sr_item_sk#85, sr_customer_sk#86, sr_cdemo_sk#87, sr_hdemo_sk#88, sr_addr_sk#89, sr_store_sk#90, sr_reason_sk#91, sr_ticket_number#92, sr_return_quantity#93, sr_return_amt#94, sr_return_tax#95, sr_return_amt_inc_tax#96, sr_fee#97, sr_return_ship_cost#98, sr_refunded_cash#99, sr_reversed_charge#100, sr_store_credit#101, sr_net_loss#102, sr_returned_date_sk#103]
Batched: true
Location: InMemoryFileIndex []
PartitionFilters: [isnotnull(sr_returned_date_sk#103), dynamicpruningexpression(sr_returned_date_sk#103 IN dynamicpruning#104)]
PushedFilters: [IsNotNull(sr_customer_sk), IsNotNull(sr_item_sk), IsNotNull(sr_ticket_number)]
ReadSchema: struct<sr_return_time_sk:int,sr_item_sk:int,sr_customer_sk:int,sr_cdemo_sk:int,sr_hdemo_sk:int,sr_addr_sk:int,sr_store_sk:int,sr_reason_sk:int,sr_ticket_number:int,sr_return_quantity:int,sr_return_amt:decimal(7,2),sr_return_tax:decimal(7,2),sr_return_amt_inc_tax:decimal(7,2),sr_fee:decimal(7,2),sr_return_ship_cost:decimal(7,2),sr_refunded_cash:decimal(7,2),sr_reversed_charge:decimal(7,2),sr_store_credit:decimal(7,2),sr_net_loss:decimal(7,2)>

(14) ColumnarToRow [codegen id : 6]
Input [20]: [sr_return_time_sk#84, sr_item_sk#85, sr_customer_sk#86, sr_cdemo_sk#87, sr_hdemo_sk#88, sr_addr_sk#89, sr_store_sk#90, sr_reason_sk#91, sr_ticket_number#92, sr_return_quantity#93, sr_return_amt#94, sr_return_tax#95, sr_return_amt_inc_tax#96, sr_fee#97, sr_return_ship_cost#98, sr_refunded_cash#99, sr_reversed_charge#100, sr_store_credit#101, sr_net_loss#102, sr_returned_date_sk#103]

(15) Filter [codegen id : 6]
Input [20]: [sr_return_time_sk#84, sr_item_sk#85, sr_customer_sk#86, sr_cdemo_sk#87, sr_hdemo_sk#88, sr_addr_sk#89, sr_store_sk#90, sr_reason_sk#91, sr_ticket_number#92, sr_return_quantity#93, sr_return_amt#94, sr_return_tax#95, sr_return_amt_inc_tax#96, sr_fee#97, sr_return_ship_cost#98, sr_refunded_cash#99, sr_reversed_charge#100, sr_store_credit#101, sr_net_loss#102, sr_returned_date_sk#103]
Condition : ((isnotnull(sr_customer_sk#86) AND isnotnull(sr_item_sk#85)) AND isnotnull(sr_ticket_number#92))

(16) ReusedExchange [Reuses operator id: 55]
Output [28]: [d_date_sk#105, d_date_id#106, d_date#107, d_month_seq#108, d_week_seq#109, d_quarter_seq#110, d_year#111, d_dow#112, d_moy#113, d_dom#114, d_qoy#115, d_fy_year#116, d_fy_quarter_seq#117, d_fy_week_seq#118, d_day_name#119, d_quarter_name#120, d_holiday#121, d_weekend#122, d_following_holiday#123, d_first_dom#124, d_last_dom#125, d_same_day_ly#126, d_same_day_lq#127, d_current_day#128, d_current_week#129, d_current_month#130, d_current_quarter#131, d_current_year#132]

(17) BroadcastHashJoin [codegen id : 6]
Left keys [1]: [sr_returned_date_sk#103]
Right keys [1]: [d_date_sk#105]
Join condition: None

(18) Exchange
Input [48]: [sr_return_time_sk#84, sr_item_sk#85, sr_customer_sk#86, sr_cdemo_sk#87, sr_hdemo_sk#88, sr_addr_sk#89, sr_store_sk#90, sr_reason_sk#91, sr_ticket_number#92, sr_return_quantity#93, sr_return_amt#94, sr_return_tax#95, sr_return_amt_inc_tax#96, sr_fee#97, sr_return_ship_cost#98, sr_refunded_cash#99, sr_reversed_charge#100, sr_store_credit#101, sr_net_loss#102, sr_returned_date_sk#103, d_date_sk#105, d_date_id#106, d_date#107, d_month_seq#108, d_week_seq#109, d_quarter_seq#110, d_year#111, d_dow#112, d_moy#113, d_dom#114, d_qoy#115, d_fy_year#116, d_fy_quarter_seq#117, d_fy_week_seq#118, d_day_name#119, d_quarter_name#120, d_holiday#121, d_weekend#122, d_following_holiday#123, d_first_dom#124, d_last_dom#125, d_same_day_ly#126, d_same_day_lq#127, d_current_day#128, d_current_week#129, d_current_month#130, d_current_quarter#131, d_current_year#132]
Arguments: hashpartitioning(sr_customer_sk#86, sr_item_sk#85, sr_ticket_number#92, 5), ENSURE_REQUIREMENTS, [id=#133]

(19) Sort [codegen id : 7]
Input [48]: [sr_return_time_sk#84, sr_item_sk#85, sr_customer_sk#86, sr_cdemo_sk#87, sr_hdemo_sk#88, sr_addr_sk#89, sr_store_sk#90, sr_reason_sk#91, sr_ticket_number#92, sr_return_quantity#93, sr_return_amt#94, sr_return_tax#95, sr_return_amt_inc_tax#96, sr_fee#97, sr_return_ship_cost#98, sr_refunded_cash#99, sr_reversed_charge#100, sr_store_credit#101, sr_net_loss#102, sr_returned_date_sk#103, d_date_sk#105, d_date_id#106, d_date#107, d_month_seq#108, d_week_seq#109, d_quarter_seq#110, d_year#111, d_dow#112, d_moy#113, d_dom#114, d_qoy#115, d_fy_year#116, d_fy_quarter_seq#117, d_fy_week_seq#118, d_day_name#119, d_quarter_name#120, d_holiday#121, d_weekend#122, d_following_holiday#123, d_first_dom#124, d_last_dom#125, d_same_day_ly#126, d_same_day_lq#127, d_current_day#128, d_current_week#129, d_current_month#130, d_current_quarter#131, d_current_year#132]
Arguments: [sr_customer_sk#86 ASC NULLS FIRST, sr_item_sk#85 ASC NULLS FIRST, sr_ticket_number#92 ASC NULLS FIRST], false, 0

(20) SortMergeJoin
Left keys [3]: [ss_customer_sk#3, ss_item_sk#2, ss_ticket_number#9]
Right keys [3]: [sr_customer_sk#86, sr_item_sk#85, sr_ticket_number#92]
Join condition: None

(21) Exchange
Input [128]: [ss_sold_time_sk#1, ss_item_sk#2, ss_customer_sk#3, ss_cdemo_sk#4, ss_hdemo_sk#5, ss_addr_sk#6, ss_store_sk#7, ss_promo_sk#8, ss_ticket_number#9, ss_quantity#10, ss_wholesale_cost#11, ss_list_price#12, ss_sales_price#13, ss_ext_discount_amt#14, ss_ext_sales_price#15, ss_ext_wholesale_cost#16, ss_ext_list_price#17, ss_ext_tax#18, ss_coupon_amt#19, ss_net_paid#20, ss_net_paid_inc_tax#21, ss_net_profit#22, ss_sold_date_sk#23, d_date_sk#25, d_date_id#26, d_date#27, d_month_seq#28, d_week_seq#29, d_quarter_seq#30, d_year#31, d_dow#32, d_moy#33, d_dom#34, d_qoy#35, d_fy_year#36, d_fy_quarter_seq#37, d_fy_week_seq#38, d_day_name#39, d_quarter_name#40, d_holiday#41, d_weekend#42, d_following_holiday#43, d_first_dom#44, d_last_dom#45, d_same_day_ly#46, d_same_day_lq#47, d_current_day#48, d_current_week#49, d_current_month#50, d_current_quarter#51, d_current_year#52, s_store_sk#53, s_store_id#54, s_rec_start_date#55, s_rec_end_date#56, s_closed_date_sk#57, s_store_name#58, s_number_employees#59, s_floor_space#60, s_hours#61, s_manager#62, s_market_id#63, s_geography_class#64, s_market_desc#65, s_market_manager#66, s_division_id#67, s_division_name#68, s_company_id#69, s_company_name#70, s_street_number#71, s_street_name#72, s_street_type#73, s_suite_number#74, s_city#75, s_county#76, s_state#77, s_zip#78, s_country#79, s_gmt_offset#80, s_tax_percentage#81, sr_return_time_sk#84, sr_item_sk#85, sr_customer_sk#86, sr_cdemo_sk#87, sr_hdemo_sk#88, sr_addr_sk#89, sr_store_sk#90, sr_reason_sk#91, sr_ticket_number#92, sr_return_quantity#93, sr_return_amt#94, sr_return_tax#95, sr_return_amt_inc_tax#96, sr_fee#97, sr_return_ship_cost#98, sr_refunded_cash#99, sr_reversed_charge#100, sr_store_credit#101, sr_net_loss#102, sr_returned_date_sk#103, d_date_sk#105, d_date_id#106, d_date#107, d_month_seq#108, d_week_seq#109, d_quarter_seq#110, d_year#111, d_dow#112, d_moy#113, d_dom#114, d_qoy#115, d_fy_year#116, d_fy_quarter_seq#117, d_fy_week_seq#118, d_day_name#119, d_quarter_name#120, d_holiday#121, d_weekend#122, d_following_holiday#123, d_first_dom#124, d_last_dom#125, d_same_day_ly#126, d_same_day_lq#127, d_current_day#128, d_current_week#129, d_current_month#130, d_current_quarter#131, d_current_year#132]
Arguments: hashpartitioning(sr_customer_sk#86, sr_item_sk#85, 5), ENSURE_REQUIREMENTS, [id=#134]

(22) Sort
Input [128]: [ss_sold_time_sk#1, ss_item_sk#2, ss_customer_sk#3, ss_cdemo_sk#4, ss_hdemo_sk#5, ss_addr_sk#6, ss_store_sk#7, ss_promo_sk#8, ss_ticket_number#9, ss_quantity#10, ss_wholesale_cost#11, ss_list_price#12, ss_sales_price#13, ss_ext_discount_amt#14, ss_ext_sales_price#15, ss_ext_wholesale_cost#16, ss_ext_list_price#17, ss_ext_tax#18, ss_coupon_amt#19, ss_net_paid#20, ss_net_paid_inc_tax#21, ss_net_profit#22, ss_sold_date_sk#23, d_date_sk#25, d_date_id#26, d_date#27, d_month_seq#28, d_week_seq#29, d_quarter_seq#30, d_year#31, d_dow#32, d_moy#33, d_dom#34, d_qoy#35, d_fy_year#36, d_fy_quarter_seq#37, d_fy_week_seq#38, d_day_name#39, d_quarter_name#40, d_holiday#41, d_weekend#42, d_following_holiday#43, d_first_dom#44, d_last_dom#45, d_same_day_ly#46, d_same_day_lq#47, d_current_day#48, d_current_week#49, d_current_month#50, d_current_quarter#51, d_current_year#52, s_store_sk#53, s_store_id#54, s_rec_start_date#55, s_rec_end_date#56, s_closed_date_sk#57, s_store_name#58, s_number_employees#59, s_floor_space#60, s_hours#61, s_manager#62, s_market_id#63, s_geography_class#64, s_market_desc#65, s_market_manager#66, s_division_id#67, s_division_name#68, s_company_id#69, s_company_name#70, s_street_number#71, s_street_name#72, s_street_type#73, s_suite_number#74, s_city#75, s_county#76, s_state#77, s_zip#78, s_country#79, s_gmt_offset#80, s_tax_percentage#81, sr_return_time_sk#84, sr_item_sk#85, sr_customer_sk#86, sr_cdemo_sk#87, sr_hdemo_sk#88, sr_addr_sk#89, sr_store_sk#90, sr_reason_sk#91, sr_ticket_number#92, sr_return_quantity#93, sr_return_amt#94, sr_return_tax#95, sr_return_amt_inc_tax#96, sr_fee#97, sr_return_ship_cost#98, sr_refunded_cash#99, sr_reversed_charge#100, sr_store_credit#101, sr_net_loss#102, sr_returned_date_sk#103, d_date_sk#105, d_date_id#106, d_date#107, d_month_seq#108, d_week_seq#109, d_quarter_seq#110, d_year#111, d_dow#112, d_moy#113, d_dom#114, d_qoy#115, d_fy_year#116, d_fy_quarter_seq#117, d_fy_week_seq#118, d_day_name#119, d_quarter_name#120, d_holiday#121, d_weekend#122, d_following_holiday#123, d_first_dom#124, d_last_dom#125, d_same_day_ly#126, d_same_day_lq#127, d_current_day#128, d_current_week#129, d_current_month#130, d_current_quarter#131, d_current_year#132]
Arguments: [sr_customer_sk#86 ASC NULLS FIRST, sr_item_sk#85 ASC NULLS FIRST], false, 0

(23) Scan parquet default.catalog_sales
Output [34]: [cs_sold_time_sk#135, cs_ship_date_sk#136, cs_bill_customer_sk#137, cs_bill_cdemo_sk#138, cs_bill_hdemo_sk#139, cs_bill_addr_sk#140, cs_ship_customer_sk#141, cs_ship_cdemo_sk#142, cs_ship_hdemo_sk#143, cs_ship_addr_sk#144, cs_call_center_sk#145, cs_catalog_page_sk#146, cs_ship_mode_sk#147, cs_warehouse_sk#148, cs_item_sk#149, cs_promo_sk#150, cs_order_number#151, cs_quantity#152, cs_wholesale_cost#153, cs_list_price#154, cs_sales_price#155, cs_ext_discount_amt#156, cs_ext_sales_price#157, cs_ext_wholesale_cost#158, cs_ext_list_price#159, cs_ext_tax#160, cs_coupon_amt#161, cs_ext_ship_cost#162, cs_net_paid#163, cs_net_paid_inc_tax#164, cs_net_paid_inc_ship#165, cs_net_paid_inc_ship_tax#166, cs_net_profit#167, cs_sold_date_sk#168]
Batched: true
Location: InMemoryFileIndex []
PartitionFilters: [isnotnull(cs_sold_date_sk#168), dynamicpruningexpression(cs_sold_date_sk#168 IN dynamicpruning#169)]
PushedFilters: [IsNotNull(cs_bill_customer_sk), IsNotNull(cs_item_sk)]
ReadSchema: struct<cs_sold_time_sk:int,cs_ship_date_sk:int,cs_bill_customer_sk:int,cs_bill_cdemo_sk:int,cs_bill_hdemo_sk:int,cs_bill_addr_sk:int,cs_ship_customer_sk:int,cs_ship_cdemo_sk:int,cs_ship_hdemo_sk:int,cs_ship_addr_sk:int,cs_call_center_sk:int,cs_catalog_page_sk:int,cs_ship_mode_sk:int,cs_warehouse_sk:int,cs_item_sk:int,cs_promo_sk:int,cs_order_number:int,cs_quantity:int,cs_wholesale_cost:decimal(7,2),cs_list_price:decimal(7,2),cs_sales_price:decimal(7,2),cs_ext_discount_amt:decimal(7,2),cs_ext_sales_price:decimal(7,2),cs_ext_wholesale_cost:decimal(7,2),cs_ext_list_price:decimal(7,2),cs_ext_tax:decimal(7,2),cs_coupon_amt:decimal(7,2),cs_ext_ship_cost:decimal(7,2),cs_net_paid:decimal(7,2),cs_net_paid_inc_tax:decimal(7,2),cs_net_paid_inc_ship:decimal(7,2),cs_net_paid_inc_ship_tax:decimal(7,2),cs_net_profit:decimal(7,2)>

(24) ColumnarToRow [codegen id : 9]
Input [34]: [cs_sold_time_sk#135, cs_ship_date_sk#136, cs_bill_customer_sk#137, cs_bill_cdemo_sk#138, cs_bill_hdemo_sk#139, cs_bill_addr_sk#140, cs_ship_customer_sk#141, cs_ship_cdemo_sk#142, cs_ship_hdemo_sk#143, cs_ship_addr_sk#144, cs_call_center_sk#145, cs_catalog_page_sk#146, cs_ship_mode_sk#147, cs_warehouse_sk#148, cs_item_sk#149, cs_promo_sk#150, cs_order_number#151, cs_quantity#152, cs_wholesale_cost#153, cs_list_price#154, cs_sales_price#155, cs_ext_discount_amt#156, cs_ext_sales_price#157, cs_ext_wholesale_cost#158, cs_ext_list_price#159, cs_ext_tax#160, cs_coupon_amt#161, cs_ext_ship_cost#162, cs_net_paid#163, cs_net_paid_inc_tax#164, cs_net_paid_inc_ship#165, cs_net_paid_inc_ship_tax#166, cs_net_profit#167, cs_sold_date_sk#168]

(25) Filter [codegen id : 9]
Input [34]: [cs_sold_time_sk#135, cs_ship_date_sk#136, cs_bill_customer_sk#137, cs_bill_cdemo_sk#138, cs_bill_hdemo_sk#139, cs_bill_addr_sk#140, cs_ship_customer_sk#141, cs_ship_cdemo_sk#142, cs_ship_hdemo_sk#143, cs_ship_addr_sk#144, cs_call_center_sk#145, cs_catalog_page_sk#146, cs_ship_mode_sk#147, cs_warehouse_sk#148, cs_item_sk#149, cs_promo_sk#150, cs_order_number#151, cs_quantity#152, cs_wholesale_cost#153, cs_list_price#154, cs_sales_price#155, cs_ext_discount_amt#156, cs_ext_sales_price#157, cs_ext_wholesale_cost#158, cs_ext_list_price#159, cs_ext_tax#160, cs_coupon_amt#161, cs_ext_ship_cost#162, cs_net_paid#163, cs_net_paid_inc_tax#164, cs_net_paid_inc_ship#165, cs_net_paid_inc_ship_tax#166, cs_net_profit#167, cs_sold_date_sk#168]
Condition : (isnotnull(cs_bill_customer_sk#137) AND isnotnull(cs_item_sk#149))

(26) ReusedExchange [Reuses operator id: 59]
Output [28]: [d_date_sk#170, d_date_id#171, d_date#172, d_month_seq#173, d_week_seq#174, d_quarter_seq#175, d_year#176, d_dow#177, d_moy#178, d_dom#179, d_qoy#180, d_fy_year#181, d_fy_quarter_seq#182, d_fy_week_seq#183, d_day_name#184, d_quarter_name#185, d_holiday#186, d_weekend#187, d_following_holiday#188, d_first_dom#189, d_last_dom#190, d_same_day_ly#191, d_same_day_lq#192, d_current_day#193, d_current_week#194, d_current_month#195, d_current_quarter#196, d_current_year#197]

(27) BroadcastHashJoin [codegen id : 9]
Left keys [1]: [cs_sold_date_sk#168]
Right keys [1]: [d_date_sk#170]
Join condition: None

(28) Exchange
Input [62]: [cs_sold_time_sk#135, cs_ship_date_sk#136, cs_bill_customer_sk#137, cs_bill_cdemo_sk#138, cs_bill_hdemo_sk#139, cs_bill_addr_sk#140, cs_ship_customer_sk#141, cs_ship_cdemo_sk#142, cs_ship_hdemo_sk#143, cs_ship_addr_sk#144, cs_call_center_sk#145, cs_catalog_page_sk#146, cs_ship_mode_sk#147, cs_warehouse_sk#148, cs_item_sk#149, cs_promo_sk#150, cs_order_number#151, cs_quantity#152, cs_wholesale_cost#153, cs_list_price#154, cs_sales_price#155, cs_ext_discount_amt#156, cs_ext_sales_price#157, cs_ext_wholesale_cost#158, cs_ext_list_price#159, cs_ext_tax#160, cs_coupon_amt#161, cs_ext_ship_cost#162, cs_net_paid#163, cs_net_paid_inc_tax#164, cs_net_paid_inc_ship#165, cs_net_paid_inc_ship_tax#166, cs_net_profit#167, cs_sold_date_sk#168, d_date_sk#170, d_date_id#171, d_date#172, d_month_seq#173, d_week_seq#174, d_quarter_seq#175, d_year#176, d_dow#177, d_moy#178, d_dom#179, d_qoy#180, d_fy_year#181, d_fy_quarter_seq#182, d_fy_week_seq#183, d_day_name#184, d_quarter_name#185, d_holiday#186, d_weekend#187, d_following_holiday#188, d_first_dom#189, d_last_dom#190, d_same_day_ly#191, d_same_day_lq#192, d_current_day#193, d_current_week#194, d_current_month#195, d_current_quarter#196, d_current_year#197]
Arguments: hashpartitioning(cs_bill_customer_sk#137, cs_item_sk#149, 5), ENSURE_REQUIREMENTS, [id=#198]

(29) Sort [codegen id : 10]
Input [62]: [cs_sold_time_sk#135, cs_ship_date_sk#136, cs_bill_customer_sk#137, cs_bill_cdemo_sk#138, cs_bill_hdemo_sk#139, cs_bill_addr_sk#140, cs_ship_customer_sk#141, cs_ship_cdemo_sk#142, cs_ship_hdemo_sk#143, cs_ship_addr_sk#144, cs_call_center_sk#145, cs_catalog_page_sk#146, cs_ship_mode_sk#147, cs_warehouse_sk#148, cs_item_sk#149, cs_promo_sk#150, cs_order_number#151, cs_quantity#152, cs_wholesale_cost#153, cs_list_price#154, cs_sales_price#155, cs_ext_discount_amt#156, cs_ext_sales_price#157, cs_ext_wholesale_cost#158, cs_ext_list_price#159, cs_ext_tax#160, cs_coupon_amt#161, cs_ext_ship_cost#162, cs_net_paid#163, cs_net_paid_inc_tax#164, cs_net_paid_inc_ship#165, cs_net_paid_inc_ship_tax#166, cs_net_profit#167, cs_sold_date_sk#168, d_date_sk#170, d_date_id#171, d_date#172, d_month_seq#173, d_week_seq#174, d_quarter_seq#175, d_year#176, d_dow#177, d_moy#178, d_dom#179, d_qoy#180, d_fy_year#181, d_fy_quarter_seq#182, d_fy_week_seq#183, d_day_name#184, d_quarter_name#185, d_holiday#186, d_weekend#187, d_following_holiday#188, d_first_dom#189, d_last_dom#190, d_same_day_ly#191, d_same_day_lq#192, d_current_day#193, d_current_week#194, d_current_month#195, d_current_quarter#196, d_current_year#197]
Arguments: [cs_bill_customer_sk#137 ASC NULLS FIRST, cs_item_sk#149 ASC NULLS FIRST], false, 0

(30) SortMergeJoin
Left keys [2]: [sr_customer_sk#86, sr_item_sk#85]
Right keys [2]: [cs_bill_customer_sk#137, cs_item_sk#149]
Join condition: None

(31) Project
Output [190]: [ss_sold_time_sk#1, ss_item_sk#2, ss_customer_sk#3, ss_cdemo_sk#4, ss_hdemo_sk#5, ss_addr_sk#6, ss_store_sk#7, ss_promo_sk#8, ss_ticket_number#9, ss_quantity#10, ss_wholesale_cost#11, ss_list_price#12, ss_sales_price#13, ss_ext_discount_amt#14, ss_ext_sales_price#15, ss_ext_wholesale_cost#16, ss_ext_list_price#17, ss_ext_tax#18, ss_coupon_amt#19, ss_net_paid#20, ss_net_paid_inc_tax#21, ss_net_profit#22, ss_sold_date_sk#23, sr_return_time_sk#84, sr_item_sk#85, sr_customer_sk#86, sr_cdemo_sk#87, sr_hdemo_sk#88, sr_addr_sk#89, sr_store_sk#90, sr_reason_sk#91, sr_ticket_number#92, sr_return_quantity#93, sr_return_amt#94, sr_return_tax#95, sr_return_amt_inc_tax#96, sr_fee#97, sr_return_ship_cost#98, sr_refunded_cash#99, sr_reversed_charge#100, sr_store_credit#101, sr_net_loss#102, sr_returned_date_sk#103, cs_sold_time_sk#135, cs_ship_date_sk#136, cs_bill_customer_sk#137, cs_bill_cdemo_sk#138, cs_bill_hdemo_sk#139, cs_bill_addr_sk#140, cs_ship_customer_sk#141, cs_ship_cdemo_sk#142, cs_ship_hdemo_sk#143, cs_ship_addr_sk#144, cs_call_center_sk#145, cs_catalog_page_sk#146, cs_ship_mode_sk#147, cs_warehouse_sk#148, cs_item_sk#149, cs_promo_sk#150, cs_order_number#151, cs_quantity#152, cs_wholesale_cost#153, cs_list_price#154, cs_sales_price#155, cs_ext_discount_amt#156, cs_ext_sales_price#157, cs_ext_wholesale_cost#158, cs_ext_list_price#159, cs_ext_tax#160, cs_coupon_amt#161, cs_ext_ship_cost#162, cs_net_paid#163, cs_net_paid_inc_tax#164, cs_net_paid_inc_ship#165, cs_net_paid_inc_ship_tax#166, cs_net_profit#167, cs_sold_date_sk#168, d_date_sk#25, d_date_id#26, d_date#27, d_month_seq#28, d_week_seq#29, d_quarter_seq#30, d_year#31, d_dow#32, d_moy#33, d_dom#34, d_qoy#35, d_fy_year#36, d_fy_quarter_seq#37, d_fy_week_seq#38, d_day_name#39, d_quarter_name#40, d_holiday#41, d_weekend#42, d_following_holiday#43, d_first_dom#44, d_last_dom#45, d_same_day_ly#46, d_same_day_lq#47, d_current_day#48, d_current_week#49, d_current_month#50, d_current_quarter#51, d_current_year#52, d_date_sk#105, d_date_id#106, d_date#107, d_month_seq#108, d_week_seq#109, d_quarter_seq#110, d_year#111, d_dow#112, d_moy#113, d_dom#114, d_qoy#115, d_fy_year#116, d_fy_quarter_seq#117, d_fy_week_seq#118, d_day_name#119, d_quarter_name#120, d_holiday#121, d_weekend#122, d_following_holiday#123, d_first_dom#124, d_last_dom#125, d_same_day_ly#126, d_same_day_lq#127, d_current_day#128, d_current_week#129, d_current_month#130, d_current_quarter#131, d_current_year#132, d_date_sk#170, d_date_id#171, d_date#172, d_month_seq#173, d_week_seq#174, d_quarter_seq#175, d_year#176, d_dow#177, d_moy#178, d_dom#179, d_qoy#180, d_fy_year#181, d_fy_quarter_seq#182, d_fy_week_seq#183, d_day_name#184, d_quarter_name#185, d_holiday#186, d_weekend#187, d_following_holiday#188, d_first_dom#189, d_last_dom#190, d_same_day_ly#191, d_same_day_lq#192, d_current_day#193, d_current_week#194, d_current_month#195, d_current_quarter#196, d_current_year#197, s_store_sk#53, s_store_id#54, s_rec_start_date#55, s_rec_end_date#56, s_closed_date_sk#57, s_store_name#58, s_number_employees#59, s_floor_space#60, s_hours#61, s_manager#62, s_market_id#63, s_geography_class#64, s_market_desc#65, s_market_manager#66, s_division_id#67, s_division_name#68, s_company_id#69, s_company_name#70, s_street_number#71, s_street_name#72, s_street_type#73, s_suite_number#74, s_city#75, s_county#76, s_state#77, s_zip#78, s_country#79, s_gmt_offset#80, s_tax_percentage#81]
Input [190]: [ss_sold_time_sk#1, ss_item_sk#2, ss_customer_sk#3, ss_cdemo_sk#4, ss_hdemo_sk#5, ss_addr_sk#6, ss_store_sk#7, ss_promo_sk#8, ss_ticket_number#9, ss_quantity#10, ss_wholesale_cost#11, ss_list_price#12, ss_sales_price#13, ss_ext_discount_amt#14, ss_ext_sales_price#15, ss_ext_wholesale_cost#16, ss_ext_list_price#17, ss_ext_tax#18, ss_coupon_amt#19, ss_net_paid#20, ss_net_paid_inc_tax#21, ss_net_profit#22, ss_sold_date_sk#23, d_date_sk#25, d_date_id#26, d_date#27, d_month_seq#28, d_week_seq#29, d_quarter_seq#30, d_year#31, d_dow#32, d_moy#33, d_dom#34, d_qoy#35, d_fy_year#36, d_fy_quarter_seq#37, d_fy_week_seq#38, d_day_name#39, d_quarter_name#40, d_holiday#41, d_weekend#42, d_following_holiday#43, d_first_dom#44, d_last_dom#45, d_same_day_ly#46, d_same_day_lq#47, d_current_day#48, d_current_week#49, d_current_month#50, d_current_quarter#51, d_current_year#52, s_store_sk#53, s_store_id#54, s_rec_start_date#55, s_rec_end_date#56, s_closed_date_sk#57, s_store_name#58, s_number_employees#59, s_floor_space#60, s_hours#61, s_manager#62, s_market_id#63, s_geography_class#64, s_market_desc#65, s_market_manager#66, s_division_id#67, s_division_name#68, s_company_id#69, s_company_name#70, s_street_number#71, s_street_name#72, s_street_type#73, s_suite_number#74, s_city#75, s_county#76, s_state#77, s_zip#78, s_country#79, s_gmt_offset#80, s_tax_percentage#81, sr_return_time_sk#84, sr_item_sk#85, sr_customer_sk#86, sr_cdemo_sk#87, sr_hdemo_sk#88, sr_addr_sk#89, sr_store_sk#90, sr_reason_sk#91, sr_ticket_number#92, sr_return_quantity#93, sr_return_amt#94, sr_return_tax#95, sr_return_amt_inc_tax#96, sr_fee#97, sr_return_ship_cost#98, sr_refunded_cash#99, sr_reversed_charge#100, sr_store_credit#101, sr_net_loss#102, sr_returned_date_sk#103, d_date_sk#105, d_date_id#106, d_date#107, d_month_seq#108, d_week_seq#109, d_quarter_seq#110, d_year#111, d_dow#112, d_moy#113, d_dom#114, d_qoy#115, d_fy_year#116, d_fy_quarter_seq#117, d_fy_week_seq#118, d_day_name#119, d_quarter_name#120, d_holiday#121, d_weekend#122, d_following_holiday#123, d_first_dom#124, d_last_dom#125, d_same_day_ly#126, d_same_day_lq#127, d_current_day#128, d_current_week#129, d_current_month#130, d_current_quarter#131, d_current_year#132, cs_sold_time_sk#135, cs_ship_date_sk#136, cs_bill_customer_sk#137, cs_bill_cdemo_sk#138, cs_bill_hdemo_sk#139, cs_bill_addr_sk#140, cs_ship_customer_sk#141, cs_ship_cdemo_sk#142, cs_ship_hdemo_sk#143, cs_ship_addr_sk#144, cs_call_center_sk#145, cs_catalog_page_sk#146, cs_ship_mode_sk#147, cs_warehouse_sk#148, cs_item_sk#149, cs_promo_sk#150, cs_order_number#151, cs_quantity#152, cs_wholesale_cost#153, cs_list_price#154, cs_sales_price#155, cs_ext_discount_amt#156, cs_ext_sales_price#157, cs_ext_wholesale_cost#158, cs_ext_list_price#159, cs_ext_tax#160, cs_coupon_amt#161, cs_ext_ship_cost#162, cs_net_paid#163, cs_net_paid_inc_tax#164, cs_net_paid_inc_ship#165, cs_net_paid_inc_ship_tax#166, cs_net_profit#167, cs_sold_date_sk#168, d_date_sk#170, d_date_id#171, d_date#172, d_month_seq#173, d_week_seq#174, d_quarter_seq#175, d_year#176, d_dow#177, d_moy#178, d_dom#179, d_qoy#180, d_fy_year#181, d_fy_quarter_seq#182, d_fy_week_seq#183, d_day_name#184, d_quarter_name#185, d_holiday#186, d_weekend#187, d_following_holiday#188, d_first_dom#189, d_last_dom#190, d_same_day_ly#191, d_same_day_lq#192, d_current_day#193, d_current_week#194, d_current_month#195, d_current_quarter#196, d_current_year#197]

(32) HashAggregate
Input [190]: [ss_sold_time_sk#1, ss_item_sk#2, ss_customer_sk#3, ss_cdemo_sk#4, ss_hdemo_sk#5, ss_addr_sk#6, ss_store_sk#7, ss_promo_sk#8, ss_ticket_number#9, ss_quantity#10, ss_wholesale_cost#11, ss_list_price#12, ss_sales_price#13, ss_ext_discount_amt#14, ss_ext_sales_price#15, ss_ext_wholesale_cost#16, ss_ext_list_price#17, ss_ext_tax#18, ss_coupon_amt#19, ss_net_paid#20, ss_net_paid_inc_tax#21, ss_net_profit#22, ss_sold_date_sk#23, sr_return_time_sk#84, sr_item_sk#85, sr_customer_sk#86, sr_cdemo_sk#87, sr_hdemo_sk#88, sr_addr_sk#89, sr_store_sk#90, sr_reason_sk#91, sr_ticket_number#92, sr_return_quantity#93, sr_return_amt#94, sr_return_tax#95, sr_return_amt_inc_tax#96, sr_fee#97, sr_return_ship_cost#98, sr_refunded_cash#99, sr_reversed_charge#100, sr_store_credit#101, sr_net_loss#102, sr_returned_date_sk#103, cs_sold_time_sk#135, cs_ship_date_sk#136, cs_bill_customer_sk#137, cs_bill_cdemo_sk#138, cs_bill_hdemo_sk#139, cs_bill_addr_sk#140, cs_ship_customer_sk#141, cs_ship_cdemo_sk#142, cs_ship_hdemo_sk#143, cs_ship_addr_sk#144, cs_call_center_sk#145, cs_catalog_page_sk#146, cs_ship_mode_sk#147, cs_warehouse_sk#148, cs_item_sk#149, cs_promo_sk#150, cs_order_number#151, cs_quantity#152, cs_wholesale_cost#153, cs_list_price#154, cs_sales_price#155, cs_ext_discount_amt#156, cs_ext_sales_price#157, cs_ext_wholesale_cost#158, cs_ext_list_price#159, cs_ext_tax#160, cs_coupon_amt#161, cs_ext_ship_cost#162, cs_net_paid#163, cs_net_paid_inc_tax#164, cs_net_paid_inc_ship#165, cs_net_paid_inc_ship_tax#166, cs_net_profit#167, cs_sold_date_sk#168, d_date_sk#25, d_date_id#26, d_date#27, d_month_seq#28, d_week_seq#29, d_quarter_seq#30, d_year#31, d_dow#32, d_moy#33, d_dom#34, d_qoy#35, d_fy_year#36, d_fy_quarter_seq#37, d_fy_week_seq#38, d_day_name#39, d_quarter_name#40, d_holiday#41, d_weekend#42, d_following_holiday#43, d_first_dom#44, d_last_dom#45, d_same_day_ly#46, d_same_day_lq#47, d_current_day#48, d_current_week#49, d_current_month#50, d_current_quarter#51, d_current_year#52, d_date_sk#105, d_date_id#106, d_date#107, d_month_seq#108, d_week_seq#109, d_quarter_seq#110, d_year#111, d_dow#112, d_moy#113, d_dom#114, d_qoy#115, d_fy_year#116, d_fy_quarter_seq#117, d_fy_week_seq#118, d_day_name#119, d_quarter_name#120, d_holiday#121, d_weekend#122, d_following_holiday#123, d_first_dom#124, d_last_dom#125, d_same_day_ly#126, d_same_day_lq#127, d_current_day#128, d_current_week#129, d_current_month#130, d_current_quarter#131, d_current_year#132, d_date_sk#170, d_date_id#171, d_date#172, d_month_seq#173, d_week_seq#174, d_quarter_seq#175, d_year#176, d_dow#177, d_moy#178, d_dom#179, d_qoy#180, d_fy_year#181, d_fy_quarter_seq#182, d_fy_week_seq#183, d_day_name#184, d_quarter_name#185, d_holiday#186, d_weekend#187, d_following_holiday#188, d_first_dom#189, d_last_dom#190, d_same_day_ly#191, d_same_day_lq#192, d_current_day#193, d_current_week#194, d_current_month#195, d_current_quarter#196, d_current_year#197, s_store_sk#53, s_store_id#54, s_rec_start_date#55, s_rec_end_date#56, s_closed_date_sk#57, s_store_name#58, s_number_employees#59, s_floor_space#60, s_hours#61, s_manager#62, s_market_id#63, s_geography_class#64, s_market_desc#65, s_market_manager#66, s_division_id#67, s_division_name#68, s_company_id#69, s_company_name#70, s_street_number#71, s_street_name#72, s_street_type#73, s_suite_number#74, s_city#75, s_county#76, s_state#77, s_zip#78, s_country#79, s_gmt_offset#80, s_tax_percentage#81]
Keys [3]: [ss_item_sk#2, s_store_id#54, s_store_name#58]
Functions [3]: [partial_sum(ss_quantity#10), partial_sum(sr_return_quantity#93), partial_sum(cs_quantity#152)]
Aggregate Attributes [3]: [sum#199, sum#200, sum#201]
Results [6]: [ss_item_sk#2, s_store_id#54, s_store_name#58, sum#202, sum#203, sum#204]

(33) Project [codegen id : 11]
Output [6]: [ss_item_sk#2, s_store_id#54, s_store_name#58, sum#202 AS _pushedexpression#205, sum#203 AS _pushedexpression#206, sum#204 AS _pushedexpression#207]
Input [6]: [ss_item_sk#2, s_store_id#54, s_store_name#58, sum#202, sum#203, sum#204]

(34) Exchange
Input [6]: [ss_item_sk#2, s_store_id#54, s_store_name#58, _pushedexpression#205, _pushedexpression#206, _pushedexpression#207]
Arguments: hashpartitioning(ss_item_sk#2, 5), ENSURE_REQUIREMENTS, [id=#208]

(35) Sort [codegen id : 12]
Input [6]: [ss_item_sk#2, s_store_id#54, s_store_name#58, _pushedexpression#205, _pushedexpression#206, _pushedexpression#207]
Arguments: [ss_item_sk#2 ASC NULLS FIRST], false, 0

(36) Scan parquet default.item
Output [22]: [i_item_sk#209, i_item_id#210, i_rec_start_date#211, i_rec_end_date#212, i_item_desc#213, i_current_price#214, i_wholesale_cost#215, i_brand_id#216, i_brand#217, i_class_id#218, i_class#219, i_category_id#220, i_category#221, i_manufact_id#222, i_manufact#223, i_size#224, i_formulation#225, i_color#226, i_units#227, i_container#228, i_manager_id#229, i_product_name#230]
Batched: true
Location [not included in comparison]/{warehouse_dir}/item]
PushedFilters: [IsNotNull(i_item_sk)]
ReadSchema: struct<i_item_sk:int,i_item_id:string,i_rec_start_date:date,i_rec_end_date:date,i_item_desc:string,i_current_price:decimal(7,2),i_wholesale_cost:decimal(7,2),i_brand_id:int,i_brand:string,i_class_id:int,i_class:string,i_category_id:int,i_category:string,i_manufact_id:int,i_manufact:string,i_size:string,i_formulation:string,i_color:string,i_units:string,i_container:string,i_manager_id:int,i_product_name:string>

(37) ColumnarToRow [codegen id : 13]
Input [22]: [i_item_sk#209, i_item_id#210, i_rec_start_date#211, i_rec_end_date#212, i_item_desc#213, i_current_price#214, i_wholesale_cost#215, i_brand_id#216, i_brand#217, i_class_id#218, i_class#219, i_category_id#220, i_category#221, i_manufact_id#222, i_manufact#223, i_size#224, i_formulation#225, i_color#226, i_units#227, i_container#228, i_manager_id#229, i_product_name#230]

(38) Filter [codegen id : 13]
Input [22]: [i_item_sk#209, i_item_id#210, i_rec_start_date#211, i_rec_end_date#212, i_item_desc#213, i_current_price#214, i_wholesale_cost#215, i_brand_id#216, i_brand#217, i_class_id#218, i_class#219, i_category_id#220, i_category#221, i_manufact_id#222, i_manufact#223, i_size#224, i_formulation#225, i_color#226, i_units#227, i_container#228, i_manager_id#229, i_product_name#230]
Condition : isnotnull(i_item_sk#209)

(39) HashAggregate [codegen id : 13]
Input [22]: [i_item_sk#209, i_item_id#210, i_rec_start_date#211, i_rec_end_date#212, i_item_desc#213, i_current_price#214, i_wholesale_cost#215, i_brand_id#216, i_brand#217, i_class_id#218, i_class#219, i_category_id#220, i_category#221, i_manufact_id#222, i_manufact#223, i_size#224, i_formulation#225, i_color#226, i_units#227, i_container#228, i_manager_id#229, i_product_name#230]
Keys [3]: [i_item_sk#209, i_item_id#210, i_item_desc#213]
Functions: []
Aggregate Attributes: []
Results [3]: [i_item_sk#209, i_item_id#210, i_item_desc#213]

(40) Exchange
Input [3]: [i_item_sk#209, i_item_id#210, i_item_desc#213]
Arguments: hashpartitioning(i_item_sk#209, 5), ENSURE_REQUIREMENTS, [id=#231]

(41) Sort [codegen id : 14]
Input [3]: [i_item_sk#209, i_item_id#210, i_item_desc#213]
Arguments: [i_item_sk#209 ASC NULLS FIRST], false, 0

(42) SortMergeJoin [codegen id : 15]
Left keys [1]: [ss_item_sk#2]
Right keys [1]: [i_item_sk#209]
Join condition: None

(43) Project [codegen id : 15]
Output [7]: [s_store_id#54, s_store_name#58, _pushedexpression#205, _pushedexpression#206, _pushedexpression#207, i_item_id#210, i_item_desc#213]
Input [9]: [ss_item_sk#2, s_store_id#54, s_store_name#58, _pushedexpression#205, _pushedexpression#206, _pushedexpression#207, i_item_sk#209, i_item_id#210, i_item_desc#213]

(44) HashAggregate [codegen id : 15]
Input [7]: [s_store_id#54, s_store_name#58, _pushedexpression#205, _pushedexpression#206, _pushedexpression#207, i_item_id#210, i_item_desc#213]
Keys [4]: [i_item_id#210, i_item_desc#213, s_store_id#54, s_store_name#58]
Functions [3]: [partial_sum(_pushedexpression#205), partial_sum(_pushedexpression#206), partial_sum(_pushedexpression#207)]
Aggregate Attributes [3]: [sum#232, sum#233, sum#234]
Results [7]: [i_item_id#210, i_item_desc#213, s_store_id#54, s_store_name#58, sum#235, sum#236, sum#237]

(45) Exchange
Input [7]: [i_item_id#210, i_item_desc#213, s_store_id#54, s_store_name#58, sum#235, sum#236, sum#237]
Arguments: hashpartitioning(i_item_id#210, i_item_desc#213, s_store_id#54, s_store_name#58, 5), ENSURE_REQUIREMENTS, [id=#238]

(46) HashAggregate [codegen id : 16]
Input [7]: [i_item_id#210, i_item_desc#213, s_store_id#54, s_store_name#58, sum#235, sum#236, sum#237]
Keys [4]: [i_item_id#210, i_item_desc#213, s_store_id#54, s_store_name#58]
Functions [3]: [sum(_pushedexpression#205), sum(_pushedexpression#206), sum(_pushedexpression#207)]
Aggregate Attributes [3]: [sum(_pushedexpression#205)#239, sum(_pushedexpression#206)#240, sum(_pushedexpression#207)#241]
Results [7]: [i_item_id#210, i_item_desc#213, s_store_id#54, s_store_name#58, sum(_pushedexpression#205)#239 AS store_sales_quantity#242, sum(_pushedexpression#206)#240 AS store_returns_quantity#243, sum(_pushedexpression#207)#241 AS catalog_sales_quantity#244]

(47) TakeOrderedAndProject
Input [7]: [i_item_id#210, i_item_desc#213, s_store_id#54, s_store_name#58, store_sales_quantity#242, store_returns_quantity#243, catalog_sales_quantity#244]
Arguments: 100, [i_item_id#210 ASC NULLS FIRST, i_item_desc#213 ASC NULLS FIRST, s_store_id#54 ASC NULLS FIRST, s_store_name#58 ASC NULLS FIRST], [i_item_id#210, i_item_desc#213, s_store_id#54, s_store_name#58, store_sales_quantity#242, store_returns_quantity#243, catalog_sales_quantity#244]

===== Subqueries =====

Subquery:1 Hosting operator id = 1 Hosting Expression = ss_sold_date_sk#23 IN dynamicpruning#24
BroadcastExchange (51)
+- * Filter (50)
   +- * ColumnarToRow (49)
      +- Scan parquet default.date_dim (48)


(48) Scan parquet default.date_dim
Output [28]: [d_date_sk#25, d_date_id#26, d_date#27, d_month_seq#28, d_week_seq#29, d_quarter_seq#30, d_year#31, d_dow#32, d_moy#33, d_dom#34, d_qoy#35, d_fy_year#36, d_fy_quarter_seq#37, d_fy_week_seq#38, d_day_name#39, d_quarter_name#40, d_holiday#41, d_weekend#42, d_following_holiday#43, d_first_dom#44, d_last_dom#45, d_same_day_ly#46, d_same_day_lq#47, d_current_day#48, d_current_week#49, d_current_month#50, d_current_quarter#51, d_current_year#52]
Batched: true
Location [not included in comparison]/{warehouse_dir}/date_dim]
PushedFilters: [IsNotNull(d_moy), IsNotNull(d_year), EqualTo(d_moy,9), EqualTo(d_year,1999), IsNotNull(d_date_sk)]
ReadSchema: struct<d_date_sk:int,d_date_id:string,d_date:date,d_month_seq:int,d_week_seq:int,d_quarter_seq:int,d_year:int,d_dow:int,d_moy:int,d_dom:int,d_qoy:int,d_fy_year:int,d_fy_quarter_seq:int,d_fy_week_seq:int,d_day_name:string,d_quarter_name:string,d_holiday:string,d_weekend:string,d_following_holiday:string,d_first_dom:int,d_last_dom:int,d_same_day_ly:int,d_same_day_lq:int,d_current_day:string,d_current_week:string,d_current_month:string,d_current_quarter:string,d_current_year:string>

(49) ColumnarToRow [codegen id : 1]
Input [28]: [d_date_sk#25, d_date_id#26, d_date#27, d_month_seq#28, d_week_seq#29, d_quarter_seq#30, d_year#31, d_dow#32, d_moy#33, d_dom#34, d_qoy#35, d_fy_year#36, d_fy_quarter_seq#37, d_fy_week_seq#38, d_day_name#39, d_quarter_name#40, d_holiday#41, d_weekend#42, d_following_holiday#43, d_first_dom#44, d_last_dom#45, d_same_day_ly#46, d_same_day_lq#47, d_current_day#48, d_current_week#49, d_current_month#50, d_current_quarter#51, d_current_year#52]

(50) Filter [codegen id : 1]
Input [28]: [d_date_sk#25, d_date_id#26, d_date#27, d_month_seq#28, d_week_seq#29, d_quarter_seq#30, d_year#31, d_dow#32, d_moy#33, d_dom#34, d_qoy#35, d_fy_year#36, d_fy_quarter_seq#37, d_fy_week_seq#38, d_day_name#39, d_quarter_name#40, d_holiday#41, d_weekend#42, d_following_holiday#43, d_first_dom#44, d_last_dom#45, d_same_day_ly#46, d_same_day_lq#47, d_current_day#48, d_current_week#49, d_current_month#50, d_current_quarter#51, d_current_year#52]
Condition : ((((isnotnull(d_moy#33) AND isnotnull(d_year#31)) AND (d_moy#33 = 9)) AND (d_year#31 = 1999)) AND isnotnull(d_date_sk#25))

(51) BroadcastExchange
Input [28]: [d_date_sk#25, d_date_id#26, d_date#27, d_month_seq#28, d_week_seq#29, d_quarter_seq#30, d_year#31, d_dow#32, d_moy#33, d_dom#34, d_qoy#35, d_fy_year#36, d_fy_quarter_seq#37, d_fy_week_seq#38, d_day_name#39, d_quarter_name#40, d_holiday#41, d_weekend#42, d_following_holiday#43, d_first_dom#44, d_last_dom#45, d_same_day_ly#46, d_same_day_lq#47, d_current_day#48, d_current_week#49, d_current_month#50, d_current_quarter#51, d_current_year#52]
Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#245]

Subquery:2 Hosting operator id = 13 Hosting Expression = sr_returned_date_sk#103 IN dynamicpruning#104
BroadcastExchange (55)
+- * Filter (54)
   +- * ColumnarToRow (53)
      +- Scan parquet default.date_dim (52)


(52) Scan parquet default.date_dim
Output [28]: [d_date_sk#105, d_date_id#106, d_date#107, d_month_seq#108, d_week_seq#109, d_quarter_seq#110, d_year#111, d_dow#112, d_moy#113, d_dom#114, d_qoy#115, d_fy_year#116, d_fy_quarter_seq#117, d_fy_week_seq#118, d_day_name#119, d_quarter_name#120, d_holiday#121, d_weekend#122, d_following_holiday#123, d_first_dom#124, d_last_dom#125, d_same_day_ly#126, d_same_day_lq#127, d_current_day#128, d_current_week#129, d_current_month#130, d_current_quarter#131, d_current_year#132]
Batched: true
Location [not included in comparison]/{warehouse_dir}/date_dim]
PushedFilters: [IsNotNull(d_moy), IsNotNull(d_year), GreaterThanOrEqual(d_moy,9), LessThanOrEqual(d_moy,12), EqualTo(d_year,1999), IsNotNull(d_date_sk)]
ReadSchema: struct<d_date_sk:int,d_date_id:string,d_date:date,d_month_seq:int,d_week_seq:int,d_quarter_seq:int,d_year:int,d_dow:int,d_moy:int,d_dom:int,d_qoy:int,d_fy_year:int,d_fy_quarter_seq:int,d_fy_week_seq:int,d_day_name:string,d_quarter_name:string,d_holiday:string,d_weekend:string,d_following_holiday:string,d_first_dom:int,d_last_dom:int,d_same_day_ly:int,d_same_day_lq:int,d_current_day:string,d_current_week:string,d_current_month:string,d_current_quarter:string,d_current_year:string>

(53) ColumnarToRow [codegen id : 1]
Input [28]: [d_date_sk#105, d_date_id#106, d_date#107, d_month_seq#108, d_week_seq#109, d_quarter_seq#110, d_year#111, d_dow#112, d_moy#113, d_dom#114, d_qoy#115, d_fy_year#116, d_fy_quarter_seq#117, d_fy_week_seq#118, d_day_name#119, d_quarter_name#120, d_holiday#121, d_weekend#122, d_following_holiday#123, d_first_dom#124, d_last_dom#125, d_same_day_ly#126, d_same_day_lq#127, d_current_day#128, d_current_week#129, d_current_month#130, d_current_quarter#131, d_current_year#132]

(54) Filter [codegen id : 1]
Input [28]: [d_date_sk#105, d_date_id#106, d_date#107, d_month_seq#108, d_week_seq#109, d_quarter_seq#110, d_year#111, d_dow#112, d_moy#113, d_dom#114, d_qoy#115, d_fy_year#116, d_fy_quarter_seq#117, d_fy_week_seq#118, d_day_name#119, d_quarter_name#120, d_holiday#121, d_weekend#122, d_following_holiday#123, d_first_dom#124, d_last_dom#125, d_same_day_ly#126, d_same_day_lq#127, d_current_day#128, d_current_week#129, d_current_month#130, d_current_quarter#131, d_current_year#132]
Condition : (((((isnotnull(d_moy#113) AND isnotnull(d_year#111)) AND (d_moy#113 >= 9)) AND (d_moy#113 <= 12)) AND (d_year#111 = 1999)) AND isnotnull(d_date_sk#105))

(55) BroadcastExchange
Input [28]: [d_date_sk#105, d_date_id#106, d_date#107, d_month_seq#108, d_week_seq#109, d_quarter_seq#110, d_year#111, d_dow#112, d_moy#113, d_dom#114, d_qoy#115, d_fy_year#116, d_fy_quarter_seq#117, d_fy_week_seq#118, d_day_name#119, d_quarter_name#120, d_holiday#121, d_weekend#122, d_following_holiday#123, d_first_dom#124, d_last_dom#125, d_same_day_ly#126, d_same_day_lq#127, d_current_day#128, d_current_week#129, d_current_month#130, d_current_quarter#131, d_current_year#132]
Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#246]

Subquery:3 Hosting operator id = 23 Hosting Expression = cs_sold_date_sk#168 IN dynamicpruning#169
BroadcastExchange (59)
+- * Filter (58)
   +- * ColumnarToRow (57)
      +- Scan parquet default.date_dim (56)


(56) Scan parquet default.date_dim
Output [28]: [d_date_sk#170, d_date_id#171, d_date#172, d_month_seq#173, d_week_seq#174, d_quarter_seq#175, d_year#176, d_dow#177, d_moy#178, d_dom#179, d_qoy#180, d_fy_year#181, d_fy_quarter_seq#182, d_fy_week_seq#183, d_day_name#184, d_quarter_name#185, d_holiday#186, d_weekend#187, d_following_holiday#188, d_first_dom#189, d_last_dom#190, d_same_day_ly#191, d_same_day_lq#192, d_current_day#193, d_current_week#194, d_current_month#195, d_current_quarter#196, d_current_year#197]
Batched: true
Location [not included in comparison]/{warehouse_dir}/date_dim]
PushedFilters: [In(d_year, [1999,2000,2001]), IsNotNull(d_date_sk)]
ReadSchema: struct<d_date_sk:int,d_date_id:string,d_date:date,d_month_seq:int,d_week_seq:int,d_quarter_seq:int,d_year:int,d_dow:int,d_moy:int,d_dom:int,d_qoy:int,d_fy_year:int,d_fy_quarter_seq:int,d_fy_week_seq:int,d_day_name:string,d_quarter_name:string,d_holiday:string,d_weekend:string,d_following_holiday:string,d_first_dom:int,d_last_dom:int,d_same_day_ly:int,d_same_day_lq:int,d_current_day:string,d_current_week:string,d_current_month:string,d_current_quarter:string,d_current_year:string>

(57) ColumnarToRow [codegen id : 1]
Input [28]: [d_date_sk#170, d_date_id#171, d_date#172, d_month_seq#173, d_week_seq#174, d_quarter_seq#175, d_year#176, d_dow#177, d_moy#178, d_dom#179, d_qoy#180, d_fy_year#181, d_fy_quarter_seq#182, d_fy_week_seq#183, d_day_name#184, d_quarter_name#185, d_holiday#186, d_weekend#187, d_following_holiday#188, d_first_dom#189, d_last_dom#190, d_same_day_ly#191, d_same_day_lq#192, d_current_day#193, d_current_week#194, d_current_month#195, d_current_quarter#196, d_current_year#197]

(58) Filter [codegen id : 1]
Input [28]: [d_date_sk#170, d_date_id#171, d_date#172, d_month_seq#173, d_week_seq#174, d_quarter_seq#175, d_year#176, d_dow#177, d_moy#178, d_dom#179, d_qoy#180, d_fy_year#181, d_fy_quarter_seq#182, d_fy_week_seq#183, d_day_name#184, d_quarter_name#185, d_holiday#186, d_weekend#187, d_following_holiday#188, d_first_dom#189, d_last_dom#190, d_same_day_ly#191, d_same_day_lq#192, d_current_day#193, d_current_week#194, d_current_month#195, d_current_quarter#196, d_current_year#197]
Condition : (d_year#176 IN (1999,2000,2001) AND isnotnull(d_date_sk#170))

(59) BroadcastExchange
Input [28]: [d_date_sk#170, d_date_id#171, d_date#172, d_month_seq#173, d_week_seq#174, d_quarter_seq#175, d_year#176, d_dow#177, d_moy#178, d_dom#179, d_qoy#180, d_fy_year#181, d_fy_quarter_seq#182, d_fy_week_seq#183, d_day_name#184, d_quarter_name#185, d_holiday#186, d_weekend#187, d_following_holiday#188, d_first_dom#189, d_last_dom#190, d_same_day_ly#191, d_same_day_lq#192, d_current_day#193, d_current_week#194, d_current_month#195, d_current_quarter#196, d_current_year#197]
Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#247]


