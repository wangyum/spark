WholeStageCodegen (11)
  Sort [ext_price,brand_id]
    InputAdapter
      Exchange [ext_price,brand_id] #1
        WholeStageCodegen (10)
          HashAggregate [i_brand,i_brand_id,t_hour,t_minute,sum,isEmpty] [sum(_pushedexpression),brand_id,brand,ext_price,sum,isEmpty]
            InputAdapter
              Exchange [i_brand,i_brand_id,t_hour,t_minute] #2
                WholeStageCodegen (9)
                  HashAggregate [i_brand,i_brand_id,t_hour,t_minute,_pushedexpression] [sum,isEmpty,sum,isEmpty]
                    Project [i_brand,i_brand_id,_pushedexpression,t_hour,t_minute]
                      BroadcastHashJoin [time_sk,t_time_sk]
                        Project [time_sk,i_brand,i_brand_id,sum]
                          HashAggregate [time_sk,i_brand,i_brand_id,ext_price] [sum,sum]
                            BroadcastHashJoin [i_item_sk,sold_item_sk]
                              InputAdapter
                                BroadcastExchange #3
                                  WholeStageCodegen (1)
                                    Filter [i_manager_id,i_item_sk]
                                      ColumnarToRow
                                        InputAdapter
                                          Scan parquet default.item [i_item_sk,i_item_id,i_rec_start_date,i_rec_end_date,i_item_desc,i_current_price,i_wholesale_cost,i_brand_id,i_brand,i_class_id,i_class,i_category_id,i_category,i_manufact_id,i_manufact,i_size,i_formulation,i_color,i_units,i_container,i_manager_id,i_product_name]
                              InputAdapter
                                Union
                                  WholeStageCodegen (3)
                                    Project [ws_ext_sales_price,ws_sold_date_sk,ws_item_sk,ws_sold_time_sk]
                                      BroadcastHashJoin [ws_sold_date_sk,d_date_sk]
                                        Filter [ws_item_sk,ws_sold_time_sk]
                                          ColumnarToRow
                                            InputAdapter
                                              Scan parquet default.web_sales [ws_sold_time_sk,ws_item_sk,ws_ext_sales_price,ws_sold_date_sk]
                                                SubqueryBroadcast [d_date_sk] #1
                                                  BroadcastExchange #4
                                                    WholeStageCodegen (1)
                                                      Project [d_date_sk]
                                                        Filter [d_moy,d_year,d_date_sk]
                                                          ColumnarToRow
                                                            InputAdapter
                                                              Scan parquet default.date_dim [d_date_sk,d_year,d_moy]
                                        InputAdapter
                                          ReusedExchange [d_date_sk] #4
                                  WholeStageCodegen (5)
                                    Project [cs_ext_sales_price,cs_sold_date_sk,cs_item_sk,cs_sold_time_sk]
                                      BroadcastHashJoin [cs_sold_date_sk,d_date_sk]
                                        Filter [cs_item_sk,cs_sold_time_sk]
                                          ColumnarToRow
                                            InputAdapter
                                              Scan parquet default.catalog_sales [cs_sold_time_sk,cs_item_sk,cs_ext_sales_price,cs_sold_date_sk]
                                                ReusedSubquery [d_date_sk] #1
                                        InputAdapter
                                          ReusedExchange [d_date_sk] #4
                                  WholeStageCodegen (7)
                                    Project [ss_ext_sales_price,ss_sold_date_sk,ss_item_sk,ss_sold_time_sk]
                                      BroadcastHashJoin [ss_sold_date_sk,d_date_sk]
                                        Filter [ss_item_sk,ss_sold_time_sk]
                                          ColumnarToRow
                                            InputAdapter
                                              Scan parquet default.store_sales [ss_sold_time_sk,ss_item_sk,ss_ext_sales_price,ss_sold_date_sk]
                                                ReusedSubquery [d_date_sk] #1
                                        InputAdapter
                                          ReusedExchange [d_date_sk] #4
                        InputAdapter
                          BroadcastExchange #5
                            WholeStageCodegen (8)
                              HashAggregate [t_time_sk,t_hour,t_minute]
                                Filter [t_meal_time,t_time_sk]
                                  ColumnarToRow
                                    InputAdapter
                                      Scan parquet default.time_dim [t_time_sk,t_time_id,t_time,t_hour,t_minute,t_second,t_am_pm,t_shift,t_sub_shift,t_meal_time]
