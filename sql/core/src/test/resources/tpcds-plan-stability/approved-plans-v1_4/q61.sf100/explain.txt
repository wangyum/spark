== Physical Plan ==
* Project (68)
+- * BroadcastNestedLoopJoin Inner BuildRight (67)
   :- * HashAggregate (44)
   :  +- Exchange (43)
   :     +- * HashAggregate (42)
   :        +- * Project (41)
   :           +- * BroadcastHashJoin Inner BuildRight (40)
   :              :- * Project (34)
   :              :  +- HashAggregate (33)
   :              :     +- Project (32)
   :              :        +- SortMergeJoin Inner (31)
   :              :           :- * Sort (17)
   :              :           :  +- Exchange (16)
   :              :           :     +- * BroadcastHashJoin Inner BuildRight (15)
   :              :           :        :- * BroadcastHashJoin Inner BuildRight (10)
   :              :           :        :  :- * BroadcastHashJoin Inner BuildRight (5)
   :              :           :        :  :  :- * Filter (3)
   :              :           :        :  :  :  +- * ColumnarToRow (2)
   :              :           :        :  :  :     +- Scan parquet default.store_sales (1)
   :              :           :        :  :  +- ReusedExchange (4)
   :              :           :        :  +- BroadcastExchange (9)
   :              :           :        :     +- * Filter (8)
   :              :           :        :        +- * ColumnarToRow (7)
   :              :           :        :           +- Scan parquet default.promotion (6)
   :              :           :        +- BroadcastExchange (14)
   :              :           :           +- * Filter (13)
   :              :           :              +- * ColumnarToRow (12)
   :              :           :                 +- Scan parquet default.store (11)
   :              :           +- * Sort (30)
   :              :              +- Exchange (29)
   :              :                 +- * SortMergeJoin Inner (28)
   :              :                    :- * Sort (22)
   :              :                    :  +- Exchange (21)
   :              :                    :     +- * Filter (20)
   :              :                    :        +- * ColumnarToRow (19)
   :              :                    :           +- Scan parquet default.customer (18)
   :              :                    +- * Sort (27)
   :              :                       +- Exchange (26)
   :              :                          +- * Filter (25)
   :              :                             +- * ColumnarToRow (24)
   :              :                                +- Scan parquet default.customer_address (23)
   :              +- BroadcastExchange (39)
   :                 +- * HashAggregate (38)
   :                    +- * Filter (37)
   :                       +- * ColumnarToRow (36)
   :                          +- Scan parquet default.item (35)
   +- BroadcastExchange (66)
      +- * HashAggregate (65)
         +- Exchange (64)
            +- * HashAggregate (63)
               +- * Project (62)
                  +- * BroadcastHashJoin Inner BuildRight (61)
                     :- * Project (59)
                     :  +- HashAggregate (58)
                     :     +- Project (57)
                     :        +- SortMergeJoin Inner (56)
                     :           :- * Sort (53)
                     :           :  +- Exchange (52)
                     :           :     +- * BroadcastHashJoin Inner BuildRight (51)
                     :           :        :- * BroadcastHashJoin Inner BuildRight (49)
                     :           :        :  :- * Filter (47)
                     :           :        :  :  +- * ColumnarToRow (46)
                     :           :        :  :     +- Scan parquet default.store_sales (45)
                     :           :        :  +- ReusedExchange (48)
                     :           :        +- ReusedExchange (50)
                     :           +- * Sort (55)
                     :              +- ReusedExchange (54)
                     +- ReusedExchange (60)


(1) Scan parquet default.store_sales
Output [23]: [ss_sold_time_sk#1, ss_item_sk#2, ss_customer_sk#3, ss_cdemo_sk#4, ss_hdemo_sk#5, ss_addr_sk#6, ss_store_sk#7, ss_promo_sk#8, ss_ticket_number#9, ss_quantity#10, ss_wholesale_cost#11, ss_list_price#12, ss_sales_price#13, ss_ext_discount_amt#14, ss_ext_sales_price#15, ss_ext_wholesale_cost#16, ss_ext_list_price#17, ss_ext_tax#18, ss_coupon_amt#19, ss_net_paid#20, ss_net_paid_inc_tax#21, ss_net_profit#22, ss_sold_date_sk#23]
Batched: true
Location: InMemoryFileIndex []
PartitionFilters: [isnotnull(ss_sold_date_sk#23), dynamicpruningexpression(ss_sold_date_sk#23 IN dynamicpruning#24)]
PushedFilters: [IsNotNull(ss_store_sk), IsNotNull(ss_item_sk), IsNotNull(ss_promo_sk), IsNotNull(ss_customer_sk)]
ReadSchema: struct<ss_sold_time_sk:int,ss_item_sk:int,ss_customer_sk:int,ss_cdemo_sk:int,ss_hdemo_sk:int,ss_addr_sk:int,ss_store_sk:int,ss_promo_sk:int,ss_ticket_number:int,ss_quantity:int,ss_wholesale_cost:decimal(7,2),ss_list_price:decimal(7,2),ss_sales_price:decimal(7,2),ss_ext_discount_amt:decimal(7,2),ss_ext_sales_price:decimal(7,2),ss_ext_wholesale_cost:decimal(7,2),ss_ext_list_price:decimal(7,2),ss_ext_tax:decimal(7,2),ss_coupon_amt:decimal(7,2),ss_net_paid:decimal(7,2),ss_net_paid_inc_tax:decimal(7,2),ss_net_profit:decimal(7,2)>

(2) ColumnarToRow [codegen id : 4]
Input [23]: [ss_sold_time_sk#1, ss_item_sk#2, ss_customer_sk#3, ss_cdemo_sk#4, ss_hdemo_sk#5, ss_addr_sk#6, ss_store_sk#7, ss_promo_sk#8, ss_ticket_number#9, ss_quantity#10, ss_wholesale_cost#11, ss_list_price#12, ss_sales_price#13, ss_ext_discount_amt#14, ss_ext_sales_price#15, ss_ext_wholesale_cost#16, ss_ext_list_price#17, ss_ext_tax#18, ss_coupon_amt#19, ss_net_paid#20, ss_net_paid_inc_tax#21, ss_net_profit#22, ss_sold_date_sk#23]

(3) Filter [codegen id : 4]
Input [23]: [ss_sold_time_sk#1, ss_item_sk#2, ss_customer_sk#3, ss_cdemo_sk#4, ss_hdemo_sk#5, ss_addr_sk#6, ss_store_sk#7, ss_promo_sk#8, ss_ticket_number#9, ss_quantity#10, ss_wholesale_cost#11, ss_list_price#12, ss_sales_price#13, ss_ext_discount_amt#14, ss_ext_sales_price#15, ss_ext_wholesale_cost#16, ss_ext_list_price#17, ss_ext_tax#18, ss_coupon_amt#19, ss_net_paid#20, ss_net_paid_inc_tax#21, ss_net_profit#22, ss_sold_date_sk#23]
Condition : (((isnotnull(ss_store_sk#7) AND isnotnull(ss_item_sk#2)) AND isnotnull(ss_promo_sk#8)) AND isnotnull(ss_customer_sk#3))

(4) ReusedExchange [Reuses operator id: 72]
Output [28]: [d_date_sk#25, d_date_id#26, d_date#27, d_month_seq#28, d_week_seq#29, d_quarter_seq#30, d_year#31, d_dow#32, d_moy#33, d_dom#34, d_qoy#35, d_fy_year#36, d_fy_quarter_seq#37, d_fy_week_seq#38, d_day_name#39, d_quarter_name#40, d_holiday#41, d_weekend#42, d_following_holiday#43, d_first_dom#44, d_last_dom#45, d_same_day_ly#46, d_same_day_lq#47, d_current_day#48, d_current_week#49, d_current_month#50, d_current_quarter#51, d_current_year#52]

(5) BroadcastHashJoin [codegen id : 4]
Left keys [1]: [ss_sold_date_sk#23]
Right keys [1]: [d_date_sk#25]
Join condition: None

(6) Scan parquet default.promotion
Output [19]: [p_promo_sk#53, p_promo_id#54, p_start_date_sk#55, p_end_date_sk#56, p_item_sk#57, p_cost#58, p_response_target#59, p_promo_name#60, p_channel_dmail#61, p_channel_email#62, p_channel_catalog#63, p_channel_tv#64, p_channel_radio#65, p_channel_press#66, p_channel_event#67, p_channel_demo#68, p_channel_details#69, p_purpose#70, p_discount_active#71]
Batched: true
Location [not included in comparison]/{warehouse_dir}/promotion]
PushedFilters: [Or(Or(EqualTo(p_channel_dmail,Y),EqualTo(p_channel_email,Y)),EqualTo(p_channel_tv,Y)), IsNotNull(p_promo_sk)]
ReadSchema: struct<p_promo_sk:int,p_promo_id:string,p_start_date_sk:int,p_end_date_sk:int,p_item_sk:int,p_cost:decimal(15,2),p_response_target:int,p_promo_name:string,p_channel_dmail:string,p_channel_email:string,p_channel_catalog:string,p_channel_tv:string,p_channel_radio:string,p_channel_press:string,p_channel_event:string,p_channel_demo:string,p_channel_details:string,p_purpose:string,p_discount_active:string>

(7) ColumnarToRow [codegen id : 2]
Input [19]: [p_promo_sk#53, p_promo_id#54, p_start_date_sk#55, p_end_date_sk#56, p_item_sk#57, p_cost#58, p_response_target#59, p_promo_name#60, p_channel_dmail#61, p_channel_email#62, p_channel_catalog#63, p_channel_tv#64, p_channel_radio#65, p_channel_press#66, p_channel_event#67, p_channel_demo#68, p_channel_details#69, p_purpose#70, p_discount_active#71]

(8) Filter [codegen id : 2]
Input [19]: [p_promo_sk#53, p_promo_id#54, p_start_date_sk#55, p_end_date_sk#56, p_item_sk#57, p_cost#58, p_response_target#59, p_promo_name#60, p_channel_dmail#61, p_channel_email#62, p_channel_catalog#63, p_channel_tv#64, p_channel_radio#65, p_channel_press#66, p_channel_event#67, p_channel_demo#68, p_channel_details#69, p_purpose#70, p_discount_active#71]
Condition : ((((p_channel_dmail#61 = Y) OR (p_channel_email#62 = Y)) OR (p_channel_tv#64 = Y)) AND isnotnull(p_promo_sk#53))

(9) BroadcastExchange
Input [19]: [p_promo_sk#53, p_promo_id#54, p_start_date_sk#55, p_end_date_sk#56, p_item_sk#57, p_cost#58, p_response_target#59, p_promo_name#60, p_channel_dmail#61, p_channel_email#62, p_channel_catalog#63, p_channel_tv#64, p_channel_radio#65, p_channel_press#66, p_channel_event#67, p_channel_demo#68, p_channel_details#69, p_purpose#70, p_discount_active#71]
Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#72]

(10) BroadcastHashJoin [codegen id : 4]
Left keys [1]: [ss_promo_sk#8]
Right keys [1]: [p_promo_sk#53]
Join condition: None

(11) Scan parquet default.store
Output [29]: [s_store_sk#73, s_store_id#74, s_rec_start_date#75, s_rec_end_date#76, s_closed_date_sk#77, s_store_name#78, s_number_employees#79, s_floor_space#80, s_hours#81, s_manager#82, s_market_id#83, s_geography_class#84, s_market_desc#85, s_market_manager#86, s_division_id#87, s_division_name#88, s_company_id#89, s_company_name#90, s_street_number#91, s_street_name#92, s_street_type#93, s_suite_number#94, s_city#95, s_county#96, s_state#97, s_zip#98, s_country#99, s_gmt_offset#100, s_tax_percentage#101]
Batched: true
Location [not included in comparison]/{warehouse_dir}/store]
PushedFilters: [IsNotNull(s_gmt_offset), EqualTo(s_gmt_offset,-5.00), IsNotNull(s_store_sk)]
ReadSchema: struct<s_store_sk:int,s_store_id:string,s_rec_start_date:date,s_rec_end_date:date,s_closed_date_sk:int,s_store_name:string,s_number_employees:int,s_floor_space:int,s_hours:string,s_manager:string,s_market_id:int,s_geography_class:string,s_market_desc:string,s_market_manager:string,s_division_id:int,s_division_name:string,s_company_id:int,s_company_name:string,s_street_number:string,s_street_name:string,s_street_type:string,s_suite_number:string,s_city:string,s_county:string,s_state:string,s_zip:string,s_country:string,s_gmt_offset:decimal(5,2),s_tax_percentage:decimal(5,2)>

(12) ColumnarToRow [codegen id : 3]
Input [29]: [s_store_sk#73, s_store_id#74, s_rec_start_date#75, s_rec_end_date#76, s_closed_date_sk#77, s_store_name#78, s_number_employees#79, s_floor_space#80, s_hours#81, s_manager#82, s_market_id#83, s_geography_class#84, s_market_desc#85, s_market_manager#86, s_division_id#87, s_division_name#88, s_company_id#89, s_company_name#90, s_street_number#91, s_street_name#92, s_street_type#93, s_suite_number#94, s_city#95, s_county#96, s_state#97, s_zip#98, s_country#99, s_gmt_offset#100, s_tax_percentage#101]

(13) Filter [codegen id : 3]
Input [29]: [s_store_sk#73, s_store_id#74, s_rec_start_date#75, s_rec_end_date#76, s_closed_date_sk#77, s_store_name#78, s_number_employees#79, s_floor_space#80, s_hours#81, s_manager#82, s_market_id#83, s_geography_class#84, s_market_desc#85, s_market_manager#86, s_division_id#87, s_division_name#88, s_company_id#89, s_company_name#90, s_street_number#91, s_street_name#92, s_street_type#93, s_suite_number#94, s_city#95, s_county#96, s_state#97, s_zip#98, s_country#99, s_gmt_offset#100, s_tax_percentage#101]
Condition : ((isnotnull(s_gmt_offset#100) AND (s_gmt_offset#100 = -5.00)) AND isnotnull(s_store_sk#73))

(14) BroadcastExchange
Input [29]: [s_store_sk#73, s_store_id#74, s_rec_start_date#75, s_rec_end_date#76, s_closed_date_sk#77, s_store_name#78, s_number_employees#79, s_floor_space#80, s_hours#81, s_manager#82, s_market_id#83, s_geography_class#84, s_market_desc#85, s_market_manager#86, s_division_id#87, s_division_name#88, s_company_id#89, s_company_name#90, s_street_number#91, s_street_name#92, s_street_type#93, s_suite_number#94, s_city#95, s_county#96, s_state#97, s_zip#98, s_country#99, s_gmt_offset#100, s_tax_percentage#101]
Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#102]

(15) BroadcastHashJoin [codegen id : 4]
Left keys [1]: [ss_store_sk#7]
Right keys [1]: [s_store_sk#73]
Join condition: None

(16) Exchange
Input [99]: [ss_sold_time_sk#1, ss_item_sk#2, ss_customer_sk#3, ss_cdemo_sk#4, ss_hdemo_sk#5, ss_addr_sk#6, ss_store_sk#7, ss_promo_sk#8, ss_ticket_number#9, ss_quantity#10, ss_wholesale_cost#11, ss_list_price#12, ss_sales_price#13, ss_ext_discount_amt#14, ss_ext_sales_price#15, ss_ext_wholesale_cost#16, ss_ext_list_price#17, ss_ext_tax#18, ss_coupon_amt#19, ss_net_paid#20, ss_net_paid_inc_tax#21, ss_net_profit#22, ss_sold_date_sk#23, d_date_sk#25, d_date_id#26, d_date#27, d_month_seq#28, d_week_seq#29, d_quarter_seq#30, d_year#31, d_dow#32, d_moy#33, d_dom#34, d_qoy#35, d_fy_year#36, d_fy_quarter_seq#37, d_fy_week_seq#38, d_day_name#39, d_quarter_name#40, d_holiday#41, d_weekend#42, d_following_holiday#43, d_first_dom#44, d_last_dom#45, d_same_day_ly#46, d_same_day_lq#47, d_current_day#48, d_current_week#49, d_current_month#50, d_current_quarter#51, d_current_year#52, p_promo_sk#53, p_promo_id#54, p_start_date_sk#55, p_end_date_sk#56, p_item_sk#57, p_cost#58, p_response_target#59, p_promo_name#60, p_channel_dmail#61, p_channel_email#62, p_channel_catalog#63, p_channel_tv#64, p_channel_radio#65, p_channel_press#66, p_channel_event#67, p_channel_demo#68, p_channel_details#69, p_purpose#70, p_discount_active#71, s_store_sk#73, s_store_id#74, s_rec_start_date#75, s_rec_end_date#76, s_closed_date_sk#77, s_store_name#78, s_number_employees#79, s_floor_space#80, s_hours#81, s_manager#82, s_market_id#83, s_geography_class#84, s_market_desc#85, s_market_manager#86, s_division_id#87, s_division_name#88, s_company_id#89, s_company_name#90, s_street_number#91, s_street_name#92, s_street_type#93, s_suite_number#94, s_city#95, s_county#96, s_state#97, s_zip#98, s_country#99, s_gmt_offset#100, s_tax_percentage#101]
Arguments: hashpartitioning(ss_customer_sk#3, 5), ENSURE_REQUIREMENTS, [id=#103]

(17) Sort [codegen id : 5]
Input [99]: [ss_sold_time_sk#1, ss_item_sk#2, ss_customer_sk#3, ss_cdemo_sk#4, ss_hdemo_sk#5, ss_addr_sk#6, ss_store_sk#7, ss_promo_sk#8, ss_ticket_number#9, ss_quantity#10, ss_wholesale_cost#11, ss_list_price#12, ss_sales_price#13, ss_ext_discount_amt#14, ss_ext_sales_price#15, ss_ext_wholesale_cost#16, ss_ext_list_price#17, ss_ext_tax#18, ss_coupon_amt#19, ss_net_paid#20, ss_net_paid_inc_tax#21, ss_net_profit#22, ss_sold_date_sk#23, d_date_sk#25, d_date_id#26, d_date#27, d_month_seq#28, d_week_seq#29, d_quarter_seq#30, d_year#31, d_dow#32, d_moy#33, d_dom#34, d_qoy#35, d_fy_year#36, d_fy_quarter_seq#37, d_fy_week_seq#38, d_day_name#39, d_quarter_name#40, d_holiday#41, d_weekend#42, d_following_holiday#43, d_first_dom#44, d_last_dom#45, d_same_day_ly#46, d_same_day_lq#47, d_current_day#48, d_current_week#49, d_current_month#50, d_current_quarter#51, d_current_year#52, p_promo_sk#53, p_promo_id#54, p_start_date_sk#55, p_end_date_sk#56, p_item_sk#57, p_cost#58, p_response_target#59, p_promo_name#60, p_channel_dmail#61, p_channel_email#62, p_channel_catalog#63, p_channel_tv#64, p_channel_radio#65, p_channel_press#66, p_channel_event#67, p_channel_demo#68, p_channel_details#69, p_purpose#70, p_discount_active#71, s_store_sk#73, s_store_id#74, s_rec_start_date#75, s_rec_end_date#76, s_closed_date_sk#77, s_store_name#78, s_number_employees#79, s_floor_space#80, s_hours#81, s_manager#82, s_market_id#83, s_geography_class#84, s_market_desc#85, s_market_manager#86, s_division_id#87, s_division_name#88, s_company_id#89, s_company_name#90, s_street_number#91, s_street_name#92, s_street_type#93, s_suite_number#94, s_city#95, s_county#96, s_state#97, s_zip#98, s_country#99, s_gmt_offset#100, s_tax_percentage#101]
Arguments: [ss_customer_sk#3 ASC NULLS FIRST], false, 0

(18) Scan parquet default.customer
Output [18]: [c_customer_sk#104, c_customer_id#105, c_current_cdemo_sk#106, c_current_hdemo_sk#107, c_current_addr_sk#108, c_first_shipto_date_sk#109, c_first_sales_date_sk#110, c_salutation#111, c_first_name#112, c_last_name#113, c_preferred_cust_flag#114, c_birth_day#115, c_birth_month#116, c_birth_year#117, c_birth_country#118, c_login#119, c_email_address#120, c_last_review_date#121]
Batched: true
Location [not included in comparison]/{warehouse_dir}/customer]
PushedFilters: [IsNotNull(c_customer_sk), IsNotNull(c_current_addr_sk)]
ReadSchema: struct<c_customer_sk:int,c_customer_id:string,c_current_cdemo_sk:int,c_current_hdemo_sk:int,c_current_addr_sk:int,c_first_shipto_date_sk:int,c_first_sales_date_sk:int,c_salutation:string,c_first_name:string,c_last_name:string,c_preferred_cust_flag:string,c_birth_day:int,c_birth_month:int,c_birth_year:int,c_birth_country:string,c_login:string,c_email_address:string,c_last_review_date:int>

(19) ColumnarToRow [codegen id : 6]
Input [18]: [c_customer_sk#104, c_customer_id#105, c_current_cdemo_sk#106, c_current_hdemo_sk#107, c_current_addr_sk#108, c_first_shipto_date_sk#109, c_first_sales_date_sk#110, c_salutation#111, c_first_name#112, c_last_name#113, c_preferred_cust_flag#114, c_birth_day#115, c_birth_month#116, c_birth_year#117, c_birth_country#118, c_login#119, c_email_address#120, c_last_review_date#121]

(20) Filter [codegen id : 6]
Input [18]: [c_customer_sk#104, c_customer_id#105, c_current_cdemo_sk#106, c_current_hdemo_sk#107, c_current_addr_sk#108, c_first_shipto_date_sk#109, c_first_sales_date_sk#110, c_salutation#111, c_first_name#112, c_last_name#113, c_preferred_cust_flag#114, c_birth_day#115, c_birth_month#116, c_birth_year#117, c_birth_country#118, c_login#119, c_email_address#120, c_last_review_date#121]
Condition : (isnotnull(c_customer_sk#104) AND isnotnull(c_current_addr_sk#108))

(21) Exchange
Input [18]: [c_customer_sk#104, c_customer_id#105, c_current_cdemo_sk#106, c_current_hdemo_sk#107, c_current_addr_sk#108, c_first_shipto_date_sk#109, c_first_sales_date_sk#110, c_salutation#111, c_first_name#112, c_last_name#113, c_preferred_cust_flag#114, c_birth_day#115, c_birth_month#116, c_birth_year#117, c_birth_country#118, c_login#119, c_email_address#120, c_last_review_date#121]
Arguments: hashpartitioning(c_current_addr_sk#108, 5), ENSURE_REQUIREMENTS, [id=#122]

(22) Sort [codegen id : 7]
Input [18]: [c_customer_sk#104, c_customer_id#105, c_current_cdemo_sk#106, c_current_hdemo_sk#107, c_current_addr_sk#108, c_first_shipto_date_sk#109, c_first_sales_date_sk#110, c_salutation#111, c_first_name#112, c_last_name#113, c_preferred_cust_flag#114, c_birth_day#115, c_birth_month#116, c_birth_year#117, c_birth_country#118, c_login#119, c_email_address#120, c_last_review_date#121]
Arguments: [c_current_addr_sk#108 ASC NULLS FIRST], false, 0

(23) Scan parquet default.customer_address
Output [13]: [ca_address_sk#123, ca_address_id#124, ca_street_number#125, ca_street_name#126, ca_street_type#127, ca_suite_number#128, ca_city#129, ca_county#130, ca_state#131, ca_zip#132, ca_country#133, ca_gmt_offset#134, ca_location_type#135]
Batched: true
Location [not included in comparison]/{warehouse_dir}/customer_address]
PushedFilters: [IsNotNull(ca_gmt_offset), EqualTo(ca_gmt_offset,-5.00), IsNotNull(ca_address_sk)]
ReadSchema: struct<ca_address_sk:int,ca_address_id:string,ca_street_number:string,ca_street_name:string,ca_street_type:string,ca_suite_number:string,ca_city:string,ca_county:string,ca_state:string,ca_zip:string,ca_country:string,ca_gmt_offset:decimal(5,2),ca_location_type:string>

(24) ColumnarToRow [codegen id : 8]
Input [13]: [ca_address_sk#123, ca_address_id#124, ca_street_number#125, ca_street_name#126, ca_street_type#127, ca_suite_number#128, ca_city#129, ca_county#130, ca_state#131, ca_zip#132, ca_country#133, ca_gmt_offset#134, ca_location_type#135]

(25) Filter [codegen id : 8]
Input [13]: [ca_address_sk#123, ca_address_id#124, ca_street_number#125, ca_street_name#126, ca_street_type#127, ca_suite_number#128, ca_city#129, ca_county#130, ca_state#131, ca_zip#132, ca_country#133, ca_gmt_offset#134, ca_location_type#135]
Condition : ((isnotnull(ca_gmt_offset#134) AND (ca_gmt_offset#134 = -5.00)) AND isnotnull(ca_address_sk#123))

(26) Exchange
Input [13]: [ca_address_sk#123, ca_address_id#124, ca_street_number#125, ca_street_name#126, ca_street_type#127, ca_suite_number#128, ca_city#129, ca_county#130, ca_state#131, ca_zip#132, ca_country#133, ca_gmt_offset#134, ca_location_type#135]
Arguments: hashpartitioning(ca_address_sk#123, 5), ENSURE_REQUIREMENTS, [id=#136]

(27) Sort [codegen id : 9]
Input [13]: [ca_address_sk#123, ca_address_id#124, ca_street_number#125, ca_street_name#126, ca_street_type#127, ca_suite_number#128, ca_city#129, ca_county#130, ca_state#131, ca_zip#132, ca_country#133, ca_gmt_offset#134, ca_location_type#135]
Arguments: [ca_address_sk#123 ASC NULLS FIRST], false, 0

(28) SortMergeJoin [codegen id : 10]
Left keys [1]: [c_current_addr_sk#108]
Right keys [1]: [ca_address_sk#123]
Join condition: None

(29) Exchange
Input [31]: [c_customer_sk#104, c_customer_id#105, c_current_cdemo_sk#106, c_current_hdemo_sk#107, c_current_addr_sk#108, c_first_shipto_date_sk#109, c_first_sales_date_sk#110, c_salutation#111, c_first_name#112, c_last_name#113, c_preferred_cust_flag#114, c_birth_day#115, c_birth_month#116, c_birth_year#117, c_birth_country#118, c_login#119, c_email_address#120, c_last_review_date#121, ca_address_sk#123, ca_address_id#124, ca_street_number#125, ca_street_name#126, ca_street_type#127, ca_suite_number#128, ca_city#129, ca_county#130, ca_state#131, ca_zip#132, ca_country#133, ca_gmt_offset#134, ca_location_type#135]
Arguments: hashpartitioning(c_customer_sk#104, 5), ENSURE_REQUIREMENTS, [id=#137]

(30) Sort [codegen id : 11]
Input [31]: [c_customer_sk#104, c_customer_id#105, c_current_cdemo_sk#106, c_current_hdemo_sk#107, c_current_addr_sk#108, c_first_shipto_date_sk#109, c_first_sales_date_sk#110, c_salutation#111, c_first_name#112, c_last_name#113, c_preferred_cust_flag#114, c_birth_day#115, c_birth_month#116, c_birth_year#117, c_birth_country#118, c_login#119, c_email_address#120, c_last_review_date#121, ca_address_sk#123, ca_address_id#124, ca_street_number#125, ca_street_name#126, ca_street_type#127, ca_suite_number#128, ca_city#129, ca_county#130, ca_state#131, ca_zip#132, ca_country#133, ca_gmt_offset#134, ca_location_type#135]
Arguments: [c_customer_sk#104 ASC NULLS FIRST], false, 0

(31) SortMergeJoin
Left keys [1]: [ss_customer_sk#3]
Right keys [1]: [c_customer_sk#104]
Join condition: None

(32) Project
Output [130]: [ss_sold_time_sk#1, ss_item_sk#2, ss_customer_sk#3, ss_cdemo_sk#4, ss_hdemo_sk#5, ss_addr_sk#6, ss_store_sk#7, ss_promo_sk#8, ss_ticket_number#9, ss_quantity#10, ss_wholesale_cost#11, ss_list_price#12, ss_sales_price#13, ss_ext_discount_amt#14, ss_ext_sales_price#15, ss_ext_wholesale_cost#16, ss_ext_list_price#17, ss_ext_tax#18, ss_coupon_amt#19, ss_net_paid#20, ss_net_paid_inc_tax#21, ss_net_profit#22, ss_sold_date_sk#23, s_store_sk#73, s_store_id#74, s_rec_start_date#75, s_rec_end_date#76, s_closed_date_sk#77, s_store_name#78, s_number_employees#79, s_floor_space#80, s_hours#81, s_manager#82, s_market_id#83, s_geography_class#84, s_market_desc#85, s_market_manager#86, s_division_id#87, s_division_name#88, s_company_id#89, s_company_name#90, s_street_number#91, s_street_name#92, s_street_type#93, s_suite_number#94, s_city#95, s_county#96, s_state#97, s_zip#98, s_country#99, s_gmt_offset#100, s_tax_percentage#101, p_promo_sk#53, p_promo_id#54, p_start_date_sk#55, p_end_date_sk#56, p_item_sk#57, p_cost#58, p_response_target#59, p_promo_name#60, p_channel_dmail#61, p_channel_email#62, p_channel_catalog#63, p_channel_tv#64, p_channel_radio#65, p_channel_press#66, p_channel_event#67, p_channel_demo#68, p_channel_details#69, p_purpose#70, p_discount_active#71, d_date_sk#25, d_date_id#26, d_date#27, d_month_seq#28, d_week_seq#29, d_quarter_seq#30, d_year#31, d_dow#32, d_moy#33, d_dom#34, d_qoy#35, d_fy_year#36, d_fy_quarter_seq#37, d_fy_week_seq#38, d_day_name#39, d_quarter_name#40, d_holiday#41, d_weekend#42, d_following_holiday#43, d_first_dom#44, d_last_dom#45, d_same_day_ly#46, d_same_day_lq#47, d_current_day#48, d_current_week#49, d_current_month#50, d_current_quarter#51, d_current_year#52, c_customer_sk#104, c_customer_id#105, c_current_cdemo_sk#106, c_current_hdemo_sk#107, c_current_addr_sk#108, c_first_shipto_date_sk#109, c_first_sales_date_sk#110, c_salutation#111, c_first_name#112, c_last_name#113, c_preferred_cust_flag#114, c_birth_day#115, c_birth_month#116, c_birth_year#117, c_birth_country#118, c_login#119, c_email_address#120, c_last_review_date#121, ca_address_sk#123, ca_address_id#124, ca_street_number#125, ca_street_name#126, ca_street_type#127, ca_suite_number#128, ca_city#129, ca_county#130, ca_state#131, ca_zip#132, ca_country#133, ca_gmt_offset#134, ca_location_type#135]
Input [130]: [ss_sold_time_sk#1, ss_item_sk#2, ss_customer_sk#3, ss_cdemo_sk#4, ss_hdemo_sk#5, ss_addr_sk#6, ss_store_sk#7, ss_promo_sk#8, ss_ticket_number#9, ss_quantity#10, ss_wholesale_cost#11, ss_list_price#12, ss_sales_price#13, ss_ext_discount_amt#14, ss_ext_sales_price#15, ss_ext_wholesale_cost#16, ss_ext_list_price#17, ss_ext_tax#18, ss_coupon_amt#19, ss_net_paid#20, ss_net_paid_inc_tax#21, ss_net_profit#22, ss_sold_date_sk#23, d_date_sk#25, d_date_id#26, d_date#27, d_month_seq#28, d_week_seq#29, d_quarter_seq#30, d_year#31, d_dow#32, d_moy#33, d_dom#34, d_qoy#35, d_fy_year#36, d_fy_quarter_seq#37, d_fy_week_seq#38, d_day_name#39, d_quarter_name#40, d_holiday#41, d_weekend#42, d_following_holiday#43, d_first_dom#44, d_last_dom#45, d_same_day_ly#46, d_same_day_lq#47, d_current_day#48, d_current_week#49, d_current_month#50, d_current_quarter#51, d_current_year#52, p_promo_sk#53, p_promo_id#54, p_start_date_sk#55, p_end_date_sk#56, p_item_sk#57, p_cost#58, p_response_target#59, p_promo_name#60, p_channel_dmail#61, p_channel_email#62, p_channel_catalog#63, p_channel_tv#64, p_channel_radio#65, p_channel_press#66, p_channel_event#67, p_channel_demo#68, p_channel_details#69, p_purpose#70, p_discount_active#71, s_store_sk#73, s_store_id#74, s_rec_start_date#75, s_rec_end_date#76, s_closed_date_sk#77, s_store_name#78, s_number_employees#79, s_floor_space#80, s_hours#81, s_manager#82, s_market_id#83, s_geography_class#84, s_market_desc#85, s_market_manager#86, s_division_id#87, s_division_name#88, s_company_id#89, s_company_name#90, s_street_number#91, s_street_name#92, s_street_type#93, s_suite_number#94, s_city#95, s_county#96, s_state#97, s_zip#98, s_country#99, s_gmt_offset#100, s_tax_percentage#101, c_customer_sk#104, c_customer_id#105, c_current_cdemo_sk#106, c_current_hdemo_sk#107, c_current_addr_sk#108, c_first_shipto_date_sk#109, c_first_sales_date_sk#110, c_salutation#111, c_first_name#112, c_last_name#113, c_preferred_cust_flag#114, c_birth_day#115, c_birth_month#116, c_birth_year#117, c_birth_country#118, c_login#119, c_email_address#120, c_last_review_date#121, ca_address_sk#123, ca_address_id#124, ca_street_number#125, ca_street_name#126, ca_street_type#127, ca_suite_number#128, ca_city#129, ca_county#130, ca_state#131, ca_zip#132, ca_country#133, ca_gmt_offset#134, ca_location_type#135]

(33) HashAggregate
Input [130]: [ss_sold_time_sk#1, ss_item_sk#2, ss_customer_sk#3, ss_cdemo_sk#4, ss_hdemo_sk#5, ss_addr_sk#6, ss_store_sk#7, ss_promo_sk#8, ss_ticket_number#9, ss_quantity#10, ss_wholesale_cost#11, ss_list_price#12, ss_sales_price#13, ss_ext_discount_amt#14, ss_ext_sales_price#15, ss_ext_wholesale_cost#16, ss_ext_list_price#17, ss_ext_tax#18, ss_coupon_amt#19, ss_net_paid#20, ss_net_paid_inc_tax#21, ss_net_profit#22, ss_sold_date_sk#23, s_store_sk#73, s_store_id#74, s_rec_start_date#75, s_rec_end_date#76, s_closed_date_sk#77, s_store_name#78, s_number_employees#79, s_floor_space#80, s_hours#81, s_manager#82, s_market_id#83, s_geography_class#84, s_market_desc#85, s_market_manager#86, s_division_id#87, s_division_name#88, s_company_id#89, s_company_name#90, s_street_number#91, s_street_name#92, s_street_type#93, s_suite_number#94, s_city#95, s_county#96, s_state#97, s_zip#98, s_country#99, s_gmt_offset#100, s_tax_percentage#101, p_promo_sk#53, p_promo_id#54, p_start_date_sk#55, p_end_date_sk#56, p_item_sk#57, p_cost#58, p_response_target#59, p_promo_name#60, p_channel_dmail#61, p_channel_email#62, p_channel_catalog#63, p_channel_tv#64, p_channel_radio#65, p_channel_press#66, p_channel_event#67, p_channel_demo#68, p_channel_details#69, p_purpose#70, p_discount_active#71, d_date_sk#25, d_date_id#26, d_date#27, d_month_seq#28, d_week_seq#29, d_quarter_seq#30, d_year#31, d_dow#32, d_moy#33, d_dom#34, d_qoy#35, d_fy_year#36, d_fy_quarter_seq#37, d_fy_week_seq#38, d_day_name#39, d_quarter_name#40, d_holiday#41, d_weekend#42, d_following_holiday#43, d_first_dom#44, d_last_dom#45, d_same_day_ly#46, d_same_day_lq#47, d_current_day#48, d_current_week#49, d_current_month#50, d_current_quarter#51, d_current_year#52, c_customer_sk#104, c_customer_id#105, c_current_cdemo_sk#106, c_current_hdemo_sk#107, c_current_addr_sk#108, c_first_shipto_date_sk#109, c_first_sales_date_sk#110, c_salutation#111, c_first_name#112, c_last_name#113, c_preferred_cust_flag#114, c_birth_day#115, c_birth_month#116, c_birth_year#117, c_birth_country#118, c_login#119, c_email_address#120, c_last_review_date#121, ca_address_sk#123, ca_address_id#124, ca_street_number#125, ca_street_name#126, ca_street_type#127, ca_suite_number#128, ca_city#129, ca_county#130, ca_state#131, ca_zip#132, ca_country#133, ca_gmt_offset#134, ca_location_type#135]
Keys [1]: [ss_item_sk#2]
Functions [1]: [partial_sum(UnscaledValue(ss_ext_sales_price#15))]
Aggregate Attributes [1]: [sum#138]
Results [2]: [ss_item_sk#2, sum#139]

(34) Project [codegen id : 13]
Output [2]: [ss_item_sk#2, sum#139 AS _pushedexpression#140]
Input [2]: [ss_item_sk#2, sum#139]

(35) Scan parquet default.item
Output [22]: [i_item_sk#141, i_item_id#142, i_rec_start_date#143, i_rec_end_date#144, i_item_desc#145, i_current_price#146, i_wholesale_cost#147, i_brand_id#148, i_brand#149, i_class_id#150, i_class#151, i_category_id#152, i_category#153, i_manufact_id#154, i_manufact#155, i_size#156, i_formulation#157, i_color#158, i_units#159, i_container#160, i_manager_id#161, i_product_name#162]
Batched: true
Location [not included in comparison]/{warehouse_dir}/item]
PushedFilters: [IsNotNull(i_category), EqualTo(i_category,Jewelry                                           ), IsNotNull(i_item_sk)]
ReadSchema: struct<i_item_sk:int,i_item_id:string,i_rec_start_date:date,i_rec_end_date:date,i_item_desc:string,i_current_price:decimal(7,2),i_wholesale_cost:decimal(7,2),i_brand_id:int,i_brand:string,i_class_id:int,i_class:string,i_category_id:int,i_category:string,i_manufact_id:int,i_manufact:string,i_size:string,i_formulation:string,i_color:string,i_units:string,i_container:string,i_manager_id:int,i_product_name:string>

(36) ColumnarToRow [codegen id : 12]
Input [22]: [i_item_sk#141, i_item_id#142, i_rec_start_date#143, i_rec_end_date#144, i_item_desc#145, i_current_price#146, i_wholesale_cost#147, i_brand_id#148, i_brand#149, i_class_id#150, i_class#151, i_category_id#152, i_category#153, i_manufact_id#154, i_manufact#155, i_size#156, i_formulation#157, i_color#158, i_units#159, i_container#160, i_manager_id#161, i_product_name#162]

(37) Filter [codegen id : 12]
Input [22]: [i_item_sk#141, i_item_id#142, i_rec_start_date#143, i_rec_end_date#144, i_item_desc#145, i_current_price#146, i_wholesale_cost#147, i_brand_id#148, i_brand#149, i_class_id#150, i_class#151, i_category_id#152, i_category#153, i_manufact_id#154, i_manufact#155, i_size#156, i_formulation#157, i_color#158, i_units#159, i_container#160, i_manager_id#161, i_product_name#162]
Condition : ((isnotnull(i_category#153) AND (i_category#153 = Jewelry                                           )) AND isnotnull(i_item_sk#141))

(38) HashAggregate [codegen id : 12]
Input [22]: [i_item_sk#141, i_item_id#142, i_rec_start_date#143, i_rec_end_date#144, i_item_desc#145, i_current_price#146, i_wholesale_cost#147, i_brand_id#148, i_brand#149, i_class_id#150, i_class#151, i_category_id#152, i_category#153, i_manufact_id#154, i_manufact#155, i_size#156, i_formulation#157, i_color#158, i_units#159, i_container#160, i_manager_id#161, i_product_name#162]
Keys [1]: [i_item_sk#141]
Functions: []
Aggregate Attributes: []
Results [1]: [i_item_sk#141]

(39) BroadcastExchange
Input [1]: [i_item_sk#141]
Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#163]

(40) BroadcastHashJoin [codegen id : 13]
Left keys [1]: [ss_item_sk#2]
Right keys [1]: [i_item_sk#141]
Join condition: None

(41) Project [codegen id : 13]
Output [1]: [_pushedexpression#164]
Input [3]: [ss_item_sk#2, _pushedexpression#140, i_item_sk#141]

(42) HashAggregate [codegen id : 13]
Input [1]: [_pushedexpression#164]
Keys: []
Functions [1]: [partial_sum(_pushedexpression#164)]
Aggregate Attributes [2]: [sum#165, isEmpty#166]
Results [2]: [sum#167, isEmpty#168]

(43) Exchange
Input [2]: [sum#167, isEmpty#168]
Arguments: SinglePartition, ENSURE_REQUIREMENTS, [id=#169]

(44) HashAggregate [codegen id : 27]
Input [2]: [sum#167, isEmpty#168]
Keys: []
Functions [1]: [sum(_pushedexpression#164)]
Aggregate Attributes [1]: [sum(_pushedexpression#164)#170]
Results [1]: [cast(sum(_pushedexpression#164)#170 as decimal(17,2)) AS promotions#171]

(45) Scan parquet default.store_sales
Output [23]: [ss_sold_time_sk#172, ss_item_sk#173, ss_customer_sk#174, ss_cdemo_sk#175, ss_hdemo_sk#176, ss_addr_sk#177, ss_store_sk#178, ss_promo_sk#179, ss_ticket_number#180, ss_quantity#181, ss_wholesale_cost#182, ss_list_price#183, ss_sales_price#184, ss_ext_discount_amt#185, ss_ext_sales_price#186, ss_ext_wholesale_cost#187, ss_ext_list_price#188, ss_ext_tax#189, ss_coupon_amt#190, ss_net_paid#191, ss_net_paid_inc_tax#192, ss_net_profit#193, ss_sold_date_sk#194]
Batched: true
Location: InMemoryFileIndex []
PartitionFilters: [isnotnull(ss_sold_date_sk#194), dynamicpruningexpression(ss_sold_date_sk#194 IN dynamicpruning#24)]
PushedFilters: [IsNotNull(ss_store_sk), IsNotNull(ss_item_sk), IsNotNull(ss_customer_sk)]
ReadSchema: struct<ss_sold_time_sk:int,ss_item_sk:int,ss_customer_sk:int,ss_cdemo_sk:int,ss_hdemo_sk:int,ss_addr_sk:int,ss_store_sk:int,ss_promo_sk:int,ss_ticket_number:int,ss_quantity:int,ss_wholesale_cost:decimal(7,2),ss_list_price:decimal(7,2),ss_sales_price:decimal(7,2),ss_ext_discount_amt:decimal(7,2),ss_ext_sales_price:decimal(7,2),ss_ext_wholesale_cost:decimal(7,2),ss_ext_list_price:decimal(7,2),ss_ext_tax:decimal(7,2),ss_coupon_amt:decimal(7,2),ss_net_paid:decimal(7,2),ss_net_paid_inc_tax:decimal(7,2),ss_net_profit:decimal(7,2)>

(46) ColumnarToRow [codegen id : 16]
Input [23]: [ss_sold_time_sk#172, ss_item_sk#173, ss_customer_sk#174, ss_cdemo_sk#175, ss_hdemo_sk#176, ss_addr_sk#177, ss_store_sk#178, ss_promo_sk#179, ss_ticket_number#180, ss_quantity#181, ss_wholesale_cost#182, ss_list_price#183, ss_sales_price#184, ss_ext_discount_amt#185, ss_ext_sales_price#186, ss_ext_wholesale_cost#187, ss_ext_list_price#188, ss_ext_tax#189, ss_coupon_amt#190, ss_net_paid#191, ss_net_paid_inc_tax#192, ss_net_profit#193, ss_sold_date_sk#194]

(47) Filter [codegen id : 16]
Input [23]: [ss_sold_time_sk#172, ss_item_sk#173, ss_customer_sk#174, ss_cdemo_sk#175, ss_hdemo_sk#176, ss_addr_sk#177, ss_store_sk#178, ss_promo_sk#179, ss_ticket_number#180, ss_quantity#181, ss_wholesale_cost#182, ss_list_price#183, ss_sales_price#184, ss_ext_discount_amt#185, ss_ext_sales_price#186, ss_ext_wholesale_cost#187, ss_ext_list_price#188, ss_ext_tax#189, ss_coupon_amt#190, ss_net_paid#191, ss_net_paid_inc_tax#192, ss_net_profit#193, ss_sold_date_sk#194]
Condition : ((isnotnull(ss_store_sk#178) AND isnotnull(ss_item_sk#173)) AND isnotnull(ss_customer_sk#174))

(48) ReusedExchange [Reuses operator id: 72]
Output [28]: [d_date_sk#195, d_date_id#196, d_date#197, d_month_seq#198, d_week_seq#199, d_quarter_seq#200, d_year#201, d_dow#202, d_moy#203, d_dom#204, d_qoy#205, d_fy_year#206, d_fy_quarter_seq#207, d_fy_week_seq#208, d_day_name#209, d_quarter_name#210, d_holiday#211, d_weekend#212, d_following_holiday#213, d_first_dom#214, d_last_dom#215, d_same_day_ly#216, d_same_day_lq#217, d_current_day#218, d_current_week#219, d_current_month#220, d_current_quarter#221, d_current_year#222]

(49) BroadcastHashJoin [codegen id : 16]
Left keys [1]: [ss_sold_date_sk#194]
Right keys [1]: [d_date_sk#195]
Join condition: None

(50) ReusedExchange [Reuses operator id: 14]
Output [29]: [s_store_sk#223, s_store_id#224, s_rec_start_date#225, s_rec_end_date#226, s_closed_date_sk#227, s_store_name#228, s_number_employees#229, s_floor_space#230, s_hours#231, s_manager#232, s_market_id#233, s_geography_class#234, s_market_desc#235, s_market_manager#236, s_division_id#237, s_division_name#238, s_company_id#239, s_company_name#240, s_street_number#241, s_street_name#242, s_street_type#243, s_suite_number#244, s_city#245, s_county#246, s_state#247, s_zip#248, s_country#249, s_gmt_offset#250, s_tax_percentage#251]

(51) BroadcastHashJoin [codegen id : 16]
Left keys [1]: [ss_store_sk#178]
Right keys [1]: [s_store_sk#223]
Join condition: None

(52) Exchange
Input [80]: [ss_sold_time_sk#172, ss_item_sk#173, ss_customer_sk#174, ss_cdemo_sk#175, ss_hdemo_sk#176, ss_addr_sk#177, ss_store_sk#178, ss_promo_sk#179, ss_ticket_number#180, ss_quantity#181, ss_wholesale_cost#182, ss_list_price#183, ss_sales_price#184, ss_ext_discount_amt#185, ss_ext_sales_price#186, ss_ext_wholesale_cost#187, ss_ext_list_price#188, ss_ext_tax#189, ss_coupon_amt#190, ss_net_paid#191, ss_net_paid_inc_tax#192, ss_net_profit#193, ss_sold_date_sk#194, d_date_sk#195, d_date_id#196, d_date#197, d_month_seq#198, d_week_seq#199, d_quarter_seq#200, d_year#201, d_dow#202, d_moy#203, d_dom#204, d_qoy#205, d_fy_year#206, d_fy_quarter_seq#207, d_fy_week_seq#208, d_day_name#209, d_quarter_name#210, d_holiday#211, d_weekend#212, d_following_holiday#213, d_first_dom#214, d_last_dom#215, d_same_day_ly#216, d_same_day_lq#217, d_current_day#218, d_current_week#219, d_current_month#220, d_current_quarter#221, d_current_year#222, s_store_sk#223, s_store_id#224, s_rec_start_date#225, s_rec_end_date#226, s_closed_date_sk#227, s_store_name#228, s_number_employees#229, s_floor_space#230, s_hours#231, s_manager#232, s_market_id#233, s_geography_class#234, s_market_desc#235, s_market_manager#236, s_division_id#237, s_division_name#238, s_company_id#239, s_company_name#240, s_street_number#241, s_street_name#242, s_street_type#243, s_suite_number#244, s_city#245, s_county#246, s_state#247, s_zip#248, s_country#249, s_gmt_offset#250, s_tax_percentage#251]
Arguments: hashpartitioning(ss_customer_sk#174, 5), ENSURE_REQUIREMENTS, [id=#252]

(53) Sort [codegen id : 17]
Input [80]: [ss_sold_time_sk#172, ss_item_sk#173, ss_customer_sk#174, ss_cdemo_sk#175, ss_hdemo_sk#176, ss_addr_sk#177, ss_store_sk#178, ss_promo_sk#179, ss_ticket_number#180, ss_quantity#181, ss_wholesale_cost#182, ss_list_price#183, ss_sales_price#184, ss_ext_discount_amt#185, ss_ext_sales_price#186, ss_ext_wholesale_cost#187, ss_ext_list_price#188, ss_ext_tax#189, ss_coupon_amt#190, ss_net_paid#191, ss_net_paid_inc_tax#192, ss_net_profit#193, ss_sold_date_sk#194, d_date_sk#195, d_date_id#196, d_date#197, d_month_seq#198, d_week_seq#199, d_quarter_seq#200, d_year#201, d_dow#202, d_moy#203, d_dom#204, d_qoy#205, d_fy_year#206, d_fy_quarter_seq#207, d_fy_week_seq#208, d_day_name#209, d_quarter_name#210, d_holiday#211, d_weekend#212, d_following_holiday#213, d_first_dom#214, d_last_dom#215, d_same_day_ly#216, d_same_day_lq#217, d_current_day#218, d_current_week#219, d_current_month#220, d_current_quarter#221, d_current_year#222, s_store_sk#223, s_store_id#224, s_rec_start_date#225, s_rec_end_date#226, s_closed_date_sk#227, s_store_name#228, s_number_employees#229, s_floor_space#230, s_hours#231, s_manager#232, s_market_id#233, s_geography_class#234, s_market_desc#235, s_market_manager#236, s_division_id#237, s_division_name#238, s_company_id#239, s_company_name#240, s_street_number#241, s_street_name#242, s_street_type#243, s_suite_number#244, s_city#245, s_county#246, s_state#247, s_zip#248, s_country#249, s_gmt_offset#250, s_tax_percentage#251]
Arguments: [ss_customer_sk#174 ASC NULLS FIRST], false, 0

(54) ReusedExchange [Reuses operator id: 29]
Output [31]: [c_customer_sk#253, c_customer_id#254, c_current_cdemo_sk#255, c_current_hdemo_sk#256, c_current_addr_sk#257, c_first_shipto_date_sk#258, c_first_sales_date_sk#259, c_salutation#260, c_first_name#261, c_last_name#262, c_preferred_cust_flag#263, c_birth_day#264, c_birth_month#265, c_birth_year#266, c_birth_country#267, c_login#268, c_email_address#269, c_last_review_date#270, ca_address_sk#271, ca_address_id#272, ca_street_number#273, ca_street_name#274, ca_street_type#275, ca_suite_number#276, ca_city#277, ca_county#278, ca_state#279, ca_zip#280, ca_country#281, ca_gmt_offset#282, ca_location_type#283]

(55) Sort [codegen id : 23]
Input [31]: [c_customer_sk#253, c_customer_id#254, c_current_cdemo_sk#255, c_current_hdemo_sk#256, c_current_addr_sk#257, c_first_shipto_date_sk#258, c_first_sales_date_sk#259, c_salutation#260, c_first_name#261, c_last_name#262, c_preferred_cust_flag#263, c_birth_day#264, c_birth_month#265, c_birth_year#266, c_birth_country#267, c_login#268, c_email_address#269, c_last_review_date#270, ca_address_sk#271, ca_address_id#272, ca_street_number#273, ca_street_name#274, ca_street_type#275, ca_suite_number#276, ca_city#277, ca_county#278, ca_state#279, ca_zip#280, ca_country#281, ca_gmt_offset#282, ca_location_type#283]
Arguments: [c_customer_sk#253 ASC NULLS FIRST], false, 0

(56) SortMergeJoin
Left keys [1]: [ss_customer_sk#174]
Right keys [1]: [c_customer_sk#253]
Join condition: None

(57) Project
Output [111]: [ss_sold_time_sk#172, ss_item_sk#173, ss_customer_sk#174, ss_cdemo_sk#175, ss_hdemo_sk#176, ss_addr_sk#177, ss_store_sk#178, ss_promo_sk#179, ss_ticket_number#180, ss_quantity#181, ss_wholesale_cost#182, ss_list_price#183, ss_sales_price#184, ss_ext_discount_amt#185, ss_ext_sales_price#186, ss_ext_wholesale_cost#187, ss_ext_list_price#188, ss_ext_tax#189, ss_coupon_amt#190, ss_net_paid#191, ss_net_paid_inc_tax#192, ss_net_profit#193, ss_sold_date_sk#194, s_store_sk#223, s_store_id#224, s_rec_start_date#225, s_rec_end_date#226, s_closed_date_sk#227, s_store_name#228, s_number_employees#229, s_floor_space#230, s_hours#231, s_manager#232, s_market_id#233, s_geography_class#234, s_market_desc#235, s_market_manager#236, s_division_id#237, s_division_name#238, s_company_id#239, s_company_name#240, s_street_number#241, s_street_name#242, s_street_type#243, s_suite_number#244, s_city#245, s_county#246, s_state#247, s_zip#248, s_country#249, s_gmt_offset#250, s_tax_percentage#251, d_date_sk#195, d_date_id#196, d_date#197, d_month_seq#198, d_week_seq#199, d_quarter_seq#200, d_year#201, d_dow#202, d_moy#203, d_dom#204, d_qoy#205, d_fy_year#206, d_fy_quarter_seq#207, d_fy_week_seq#208, d_day_name#209, d_quarter_name#210, d_holiday#211, d_weekend#212, d_following_holiday#213, d_first_dom#214, d_last_dom#215, d_same_day_ly#216, d_same_day_lq#217, d_current_day#218, d_current_week#219, d_current_month#220, d_current_quarter#221, d_current_year#222, c_customer_sk#253, c_customer_id#254, c_current_cdemo_sk#255, c_current_hdemo_sk#256, c_current_addr_sk#257, c_first_shipto_date_sk#258, c_first_sales_date_sk#259, c_salutation#260, c_first_name#261, c_last_name#262, c_preferred_cust_flag#263, c_birth_day#264, c_birth_month#265, c_birth_year#266, c_birth_country#267, c_login#268, c_email_address#269, c_last_review_date#270, ca_address_sk#271, ca_address_id#272, ca_street_number#273, ca_street_name#274, ca_street_type#275, ca_suite_number#276, ca_city#277, ca_county#278, ca_state#279, ca_zip#280, ca_country#281, ca_gmt_offset#282, ca_location_type#283]
Input [111]: [ss_sold_time_sk#172, ss_item_sk#173, ss_customer_sk#174, ss_cdemo_sk#175, ss_hdemo_sk#176, ss_addr_sk#177, ss_store_sk#178, ss_promo_sk#179, ss_ticket_number#180, ss_quantity#181, ss_wholesale_cost#182, ss_list_price#183, ss_sales_price#184, ss_ext_discount_amt#185, ss_ext_sales_price#186, ss_ext_wholesale_cost#187, ss_ext_list_price#188, ss_ext_tax#189, ss_coupon_amt#190, ss_net_paid#191, ss_net_paid_inc_tax#192, ss_net_profit#193, ss_sold_date_sk#194, d_date_sk#195, d_date_id#196, d_date#197, d_month_seq#198, d_week_seq#199, d_quarter_seq#200, d_year#201, d_dow#202, d_moy#203, d_dom#204, d_qoy#205, d_fy_year#206, d_fy_quarter_seq#207, d_fy_week_seq#208, d_day_name#209, d_quarter_name#210, d_holiday#211, d_weekend#212, d_following_holiday#213, d_first_dom#214, d_last_dom#215, d_same_day_ly#216, d_same_day_lq#217, d_current_day#218, d_current_week#219, d_current_month#220, d_current_quarter#221, d_current_year#222, s_store_sk#223, s_store_id#224, s_rec_start_date#225, s_rec_end_date#226, s_closed_date_sk#227, s_store_name#228, s_number_employees#229, s_floor_space#230, s_hours#231, s_manager#232, s_market_id#233, s_geography_class#234, s_market_desc#235, s_market_manager#236, s_division_id#237, s_division_name#238, s_company_id#239, s_company_name#240, s_street_number#241, s_street_name#242, s_street_type#243, s_suite_number#244, s_city#245, s_county#246, s_state#247, s_zip#248, s_country#249, s_gmt_offset#250, s_tax_percentage#251, c_customer_sk#253, c_customer_id#254, c_current_cdemo_sk#255, c_current_hdemo_sk#256, c_current_addr_sk#257, c_first_shipto_date_sk#258, c_first_sales_date_sk#259, c_salutation#260, c_first_name#261, c_last_name#262, c_preferred_cust_flag#263, c_birth_day#264, c_birth_month#265, c_birth_year#266, c_birth_country#267, c_login#268, c_email_address#269, c_last_review_date#270, ca_address_sk#271, ca_address_id#272, ca_street_number#273, ca_street_name#274, ca_street_type#275, ca_suite_number#276, ca_city#277, ca_county#278, ca_state#279, ca_zip#280, ca_country#281, ca_gmt_offset#282, ca_location_type#283]

(58) HashAggregate
Input [111]: [ss_sold_time_sk#172, ss_item_sk#173, ss_customer_sk#174, ss_cdemo_sk#175, ss_hdemo_sk#176, ss_addr_sk#177, ss_store_sk#178, ss_promo_sk#179, ss_ticket_number#180, ss_quantity#181, ss_wholesale_cost#182, ss_list_price#183, ss_sales_price#184, ss_ext_discount_amt#185, ss_ext_sales_price#186, ss_ext_wholesale_cost#187, ss_ext_list_price#188, ss_ext_tax#189, ss_coupon_amt#190, ss_net_paid#191, ss_net_paid_inc_tax#192, ss_net_profit#193, ss_sold_date_sk#194, s_store_sk#223, s_store_id#224, s_rec_start_date#225, s_rec_end_date#226, s_closed_date_sk#227, s_store_name#228, s_number_employees#229, s_floor_space#230, s_hours#231, s_manager#232, s_market_id#233, s_geography_class#234, s_market_desc#235, s_market_manager#236, s_division_id#237, s_division_name#238, s_company_id#239, s_company_name#240, s_street_number#241, s_street_name#242, s_street_type#243, s_suite_number#244, s_city#245, s_county#246, s_state#247, s_zip#248, s_country#249, s_gmt_offset#250, s_tax_percentage#251, d_date_sk#195, d_date_id#196, d_date#197, d_month_seq#198, d_week_seq#199, d_quarter_seq#200, d_year#201, d_dow#202, d_moy#203, d_dom#204, d_qoy#205, d_fy_year#206, d_fy_quarter_seq#207, d_fy_week_seq#208, d_day_name#209, d_quarter_name#210, d_holiday#211, d_weekend#212, d_following_holiday#213, d_first_dom#214, d_last_dom#215, d_same_day_ly#216, d_same_day_lq#217, d_current_day#218, d_current_week#219, d_current_month#220, d_current_quarter#221, d_current_year#222, c_customer_sk#253, c_customer_id#254, c_current_cdemo_sk#255, c_current_hdemo_sk#256, c_current_addr_sk#257, c_first_shipto_date_sk#258, c_first_sales_date_sk#259, c_salutation#260, c_first_name#261, c_last_name#262, c_preferred_cust_flag#263, c_birth_day#264, c_birth_month#265, c_birth_year#266, c_birth_country#267, c_login#268, c_email_address#269, c_last_review_date#270, ca_address_sk#271, ca_address_id#272, ca_street_number#273, ca_street_name#274, ca_street_type#275, ca_suite_number#276, ca_city#277, ca_county#278, ca_state#279, ca_zip#280, ca_country#281, ca_gmt_offset#282, ca_location_type#283]
Keys [1]: [ss_item_sk#173]
Functions [1]: [partial_sum(UnscaledValue(ss_ext_sales_price#186))]
Aggregate Attributes [1]: [sum#284]
Results [2]: [ss_item_sk#173, sum#285]

(59) Project [codegen id : 25]
Output [2]: [ss_item_sk#173, sum#285 AS _pushedexpression#286]
Input [2]: [ss_item_sk#173, sum#285]

(60) ReusedExchange [Reuses operator id: 39]
Output [1]: [i_item_sk#287]

(61) BroadcastHashJoin [codegen id : 25]
Left keys [1]: [ss_item_sk#173]
Right keys [1]: [i_item_sk#287]
Join condition: None

(62) Project [codegen id : 25]
Output [1]: [_pushedexpression#288]
Input [3]: [ss_item_sk#173, _pushedexpression#286, i_item_sk#287]

(63) HashAggregate [codegen id : 25]
Input [1]: [_pushedexpression#288]
Keys: []
Functions [1]: [partial_sum(_pushedexpression#288)]
Aggregate Attributes [2]: [sum#289, isEmpty#290]
Results [2]: [sum#291, isEmpty#292]

(64) Exchange
Input [2]: [sum#291, isEmpty#292]
Arguments: SinglePartition, ENSURE_REQUIREMENTS, [id=#293]

(65) HashAggregate [codegen id : 26]
Input [2]: [sum#291, isEmpty#292]
Keys: []
Functions [1]: [sum(_pushedexpression#288)]
Aggregate Attributes [1]: [sum(_pushedexpression#288)#294]
Results [1]: [cast(sum(_pushedexpression#288)#294 as decimal(17,2)) AS total#295]

(66) BroadcastExchange
Input [1]: [total#295]
Arguments: IdentityBroadcastMode, [id=#296]

(67) BroadcastNestedLoopJoin [codegen id : 27]
Join condition: None

(68) Project [codegen id : 27]
Output [3]: [promotions#171, total#295, CheckOverflow((promote_precision(CheckOverflow((promote_precision(cast(promotions#171 as decimal(15,4))) / promote_precision(cast(total#295 as decimal(15,4)))), DecimalType(35,20))) * 100.00000000000000000000), DecimalType(38,19)) AS ((CAST(promotions AS DECIMAL(15,4)) / CAST(total AS DECIMAL(15,4))) * 100)#297]
Input [2]: [promotions#171, total#295]

===== Subqueries =====

Subquery:1 Hosting operator id = 1 Hosting Expression = ss_sold_date_sk#23 IN dynamicpruning#24
BroadcastExchange (72)
+- * Filter (71)
   +- * ColumnarToRow (70)
      +- Scan parquet default.date_dim (69)


(69) Scan parquet default.date_dim
Output [28]: [d_date_sk#25, d_date_id#26, d_date#27, d_month_seq#28, d_week_seq#29, d_quarter_seq#30, d_year#31, d_dow#32, d_moy#33, d_dom#34, d_qoy#35, d_fy_year#36, d_fy_quarter_seq#37, d_fy_week_seq#38, d_day_name#39, d_quarter_name#40, d_holiday#41, d_weekend#42, d_following_holiday#43, d_first_dom#44, d_last_dom#45, d_same_day_ly#46, d_same_day_lq#47, d_current_day#48, d_current_week#49, d_current_month#50, d_current_quarter#51, d_current_year#52]
Batched: true
Location [not included in comparison]/{warehouse_dir}/date_dim]
PushedFilters: [IsNotNull(d_year), IsNotNull(d_moy), EqualTo(d_year,1998), EqualTo(d_moy,11), IsNotNull(d_date_sk)]
ReadSchema: struct<d_date_sk:int,d_date_id:string,d_date:date,d_month_seq:int,d_week_seq:int,d_quarter_seq:int,d_year:int,d_dow:int,d_moy:int,d_dom:int,d_qoy:int,d_fy_year:int,d_fy_quarter_seq:int,d_fy_week_seq:int,d_day_name:string,d_quarter_name:string,d_holiday:string,d_weekend:string,d_following_holiday:string,d_first_dom:int,d_last_dom:int,d_same_day_ly:int,d_same_day_lq:int,d_current_day:string,d_current_week:string,d_current_month:string,d_current_quarter:string,d_current_year:string>

(70) ColumnarToRow [codegen id : 1]
Input [28]: [d_date_sk#25, d_date_id#26, d_date#27, d_month_seq#28, d_week_seq#29, d_quarter_seq#30, d_year#31, d_dow#32, d_moy#33, d_dom#34, d_qoy#35, d_fy_year#36, d_fy_quarter_seq#37, d_fy_week_seq#38, d_day_name#39, d_quarter_name#40, d_holiday#41, d_weekend#42, d_following_holiday#43, d_first_dom#44, d_last_dom#45, d_same_day_ly#46, d_same_day_lq#47, d_current_day#48, d_current_week#49, d_current_month#50, d_current_quarter#51, d_current_year#52]

(71) Filter [codegen id : 1]
Input [28]: [d_date_sk#25, d_date_id#26, d_date#27, d_month_seq#28, d_week_seq#29, d_quarter_seq#30, d_year#31, d_dow#32, d_moy#33, d_dom#34, d_qoy#35, d_fy_year#36, d_fy_quarter_seq#37, d_fy_week_seq#38, d_day_name#39, d_quarter_name#40, d_holiday#41, d_weekend#42, d_following_holiday#43, d_first_dom#44, d_last_dom#45, d_same_day_ly#46, d_same_day_lq#47, d_current_day#48, d_current_week#49, d_current_month#50, d_current_quarter#51, d_current_year#52]
Condition : ((((isnotnull(d_year#31) AND isnotnull(d_moy#33)) AND (d_year#31 = 1998)) AND (d_moy#33 = 11)) AND isnotnull(d_date_sk#25))

(72) BroadcastExchange
Input [28]: [d_date_sk#25, d_date_id#26, d_date#27, d_month_seq#28, d_week_seq#29, d_quarter_seq#30, d_year#31, d_dow#32, d_moy#33, d_dom#34, d_qoy#35, d_fy_year#36, d_fy_quarter_seq#37, d_fy_week_seq#38, d_day_name#39, d_quarter_name#40, d_holiday#41, d_weekend#42, d_following_holiday#43, d_first_dom#44, d_last_dom#45, d_same_day_ly#46, d_same_day_lq#47, d_current_day#48, d_current_week#49, d_current_month#50, d_current_quarter#51, d_current_year#52]
Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#298]

Subquery:2 Hosting operator id = 45 Hosting Expression = ss_sold_date_sk#194 IN dynamicpruning#24


